(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9970],{76998:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},53219:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},61749:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},13025:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},6553:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]])},7314:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},78276:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]])},38583:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]])},73696:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},57307:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},55348:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]])},41830:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]])},87720:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tattoo/try/[trial_id]",function(){return a(22572)}])},81186:function(e,t,a){"use strict";a.d(t,{O:function(){return Skeleton}});var s=a(85893),l=a(46283);function Skeleton(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",t),...a})}},98182:function(e,t,a){"use strict";a.d(t,{i:function(){return n}});var s=a(85893),l=a(67294),r=a(68482),i=a(46283);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(r.fC,{ref:t,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",a),...l,children:[(0,s.jsx)(r.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,s.jsx)(r.e6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(r.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=r.fC.displayName},9081:function(e,t,a){"use strict";a.d(t,{r:function(){return n}});var s=a(85893),l=a(67294),r=a(60761),i=a(46283);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:t,children:(0,s.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});n.displayName=r.fC.displayName},83100:function(e,t,a){"use strict";a.d(t,{Z:function(){return FileUploader}});var s=a(85893),l=a(67294),r=a(37655),i=a(4175);function FileUploader(e){let{finderShow:t,finderMode:a,displayMode:r="button",files:i=[],onChange:n,multiple:o=!0,widget_id:d,pubKey:c}=e,[m,u]=(0,l.useState)([]),h=(0,l.useRef)(null);return(0,l.useCallback)(e=>n(i.filter(t=>t.uuid!==e)),[i,n]),(0,l.useEffect)(()=>{var e;let handleUploadEvent=e=>{console.log("handleUploadEvent",e),e.detail&&u([...e.detail])};return null===(e=h.current)||void 0===e||e.addEventListener("data-output",handleUploadEvent),()=>{var e;null===(e=h.current)||void 0===e||e.removeEventListener("data-output",handleUploadEvent)}},[u]),(0,l.useEffect)(()=>{if(t){var e;null===(e=h.current)||void 0===e||e.uploadCollection.clearAll()}},[a,t]),(0,l.useEffect)(()=>{var e,t;let resetUploaderState=()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.uploadCollection.clearAll()},handleDoneFlow=e=>{console.log("Done flow"),console.log(e),n(e.detail.successEntries),resetUploaderState()},handleUploadSuccessFlow=e=>{console.log("Success Upload"),console.log(e),n(e.detail.successEntries)};return null===(e=h.current)||void 0===e||e.addEventListener("done-click",handleDoneFlow),("inline"===r||"minimal"===r)&&(null===(t=h.current)||void 0===t||t.addEventListener("change",handleUploadSuccessFlow)),()=>{var e,t;null===(e=h.current)||void 0===e||e.removeEventListener("done-click",handleDoneFlow),("inline"===r||"minimal"===r)&&(null===(t=h.current)||void 0===t||t.removeEventListener("change",handleUploadSuccessFlow))}},[i,n,m,u]),(0,s.jsxs)("div",{children:[(0,s.jsx)("lr-config",{"ctx-name":"my-uploader-"+d,pubkey:c,multiple:o,sourceList:"local, url, camera, dropbox, gdrive",confirmUpload:!1,removeCopyright:!0,imgOnly:!0}),"button"===r&&(0,s.jsxs)("div",{children:[(0,s.jsx)("lr-file-uploader-regular",{"ctx-name":"my-uploader-"+d,"css-src":"https://cdn.jsdelivr.net/npm/@uploadcare/blocks@0.32.0/web/lr-file-uploader-regular.min.css",class:""}),(0,s.jsx)("lr-upload-ctx-provider",{"ctx-name":"my-uploader-"+d,ref:h})]}),"inline"===r&&(0,s.jsx)("div",{children:(0,s.jsx)("lr-file-uploader-inline",{"css-src":"https://cdn.jsdelivr.net/npm/@uploadcare/blocks@0.30.0/web/lr-file-uploader-inline.min.css","ctx-name":"my-uploader-"+d})}),"minimal"===r&&(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("lr-file-uploader-minimal",{"css-src":"https://cdn.jsdelivr.net/npm/@uploadcare/blocks@0.22.9/web/file-uploader-minimal.min.css","ctx-name":"my-uploader-"+d,class:"uploader-cfg"})}),(0,s.jsx)("lr-upload-ctx-provider",{"ctx-name":"my-uploader-"+d,ref:h})]})}r.n(i)},68578:function(e,t,a){"use strict";a.d(t,{E2:function(){return i},Eb:function(){return r},_R:function(){return l},yY:function(){return s}});let s="5554127570263484bba9",l="5554127570263484bba9",r="2080dd4e48a11ba3ab74",i=[{model:"basic",name:"basic",price:1},{model:"detailed",name:"detailed",price:4}]},98977:function(e,t,a){"use strict";let s,l;a.d(t,{s:function(){return generateMask}});var r=a(10203);async function urlToImageBitmap(e){try{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch image: ".concat(t.statusText));let a=await t.blob(),s=await createImageBitmap(a);return s}catch(e){console.error("Error converting image URL to ImageBitmap:",e)}}let createImageSegmenter=async()=>{let e=await r.n.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.2/wasm");l=(s=await r.cW.createFromOptions(e,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/image_segmenter/selfie_multiclass_256x256/float32/latest/selfie_multiclass_256x256.tflite",delegate:"GPU"},runningMode:"IMAGE",outputCategoryMask:!0,outputConfidenceMasks:!1})).getLabels()},generateMask=async e=>{let{url:t}=e;{let e=await new Promise(async(e,a)=>{s||await createImageSegmenter();let r=await urlToImageBitmap(t);if(void 0===s)return;let i=document.createElement("canvas");i.width=400,i.height=600;let n=i.getContext("2d");n.clearRect(0,0,i.width,i.height),n.drawImage(r,0,0,i.width,i.height),s.segment(r,function(t){let a=document.createElement("canvas"),s=a.getContext("2d"),{width:r,height:i}=t.categoryMask,n=s.getImageData(0,0,r,i).data;a.width=r,a.height=i;let o=t.categoryMask.getAsUint8Array();for(let e in window.location.href.includes("?debug=true")&&window.alert(JSON.stringify(l)),o){let t=l[o[e]];["body-skin","face-skin"].includes(t)?(n[4*e]=0,n[4*e+1]=0,n[4*e+2]=0,n[4*e+3]=255):n[4*e+3]=0}let d=new Uint8ClampedArray(n.buffer),c=new ImageData(d,r,i);s.putImageData(c,0,0);let m=a.toDataURL();e(m)})});return e}}},22572:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return ef},default:function(){return TrialPage}});var s=a(85893),l=a(67294),r=a(43),i=a(4298),n=a.n(i),o=a(98938),d=a(53225),c=a(53317),m=a(67814),u=a(59417),h=a(86896),g=a(11163),p=a(9008),x=a.n(p),f=a(39332),v=a(5608),w=a(8513),y=a(49695),b=a(13557),j=a(82701),N=a(37838),_=a(4844),k=a(31012),S=a(73696),M=a(76915),C=a(41352),E=a(91373);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let z=(0,E.Z)("PackageOpen",[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]]);var U=a(98814),D=a(54463);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let I=(0,E.Z)("Scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);var P=a(6553),T=a(78276),Z=a(38583),L=a(13025);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let O=(0,E.Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var R=a(36316),F=a(57307),A=a(78183),B=a(7314),W=a(53219),q=a(61749),H=a(76998),G=a(98182),V=a(80691),X=a(43761),Y=a(46117),J=a(90510),K=a(41664),Q=a.n(K),$=a(90092),ee=a(98977),et=a(77546),ea=a(9081),es=a(81354),el=a.n(es),er=a(92193),ei=a(48980),en=a(17313),eo=a(15319),ed=a(29095),ec=a(99477),em=a(30713),eu=a(62888);/**
 * @license lucide-react v0.426.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let eh=(0,E.Z)("Pointer",[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]]),eg=(0,E.Z)("Blend",[["circle",{cx:"9",cy:"9",r:"7",key:"p2h5vp"}],["circle",{cx:"15",cy:"15",r:"7",key:"19ennj"}]]),ep=(0,E.Z)("CircleChevronLeft",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m14 16-4-4 4-4",key:"ojs7w8"}]]);var ex=a(41830);let throttle=(e,t)=>{let a;return function(){let s=arguments;a||(e.apply(this,s),a=!0,setTimeout(()=>a=!1,t))}};function EraserMap(e){let{currentFullSnapshot:t,backgroundImage:a,onExport:r,width:i,height:n,onClose:o,addWatermark:d,downloadOrShare:c,trial:m=null}=e,u=(0,l.useRef)(null),[g,p]=(0,l.useState)(!1),[x,f]=(0,l.useState)([]),[v,w]=(0,l.useState)(18),[y,j]=(0,l.useState)(!1),N=(0,h.Z)(),_=(0,l.useCallback)(e=>{if(!g)return;let t=u.current.getContext("2d"),a=u.current.getBoundingClientRect(),s=(e.touches?e.touches[0].clientX:e.clientX)-a.left,l=(e.touches?e.touches[0].clientY:e.clientY)-a.top;f(e=>[...e,{x:s,y:l}]),t.globalCompositeOperation="destination-out";let r=t.createRadialGradient(s,l,0,s,l,v);r.addColorStop(0,"rgba(0,0,0,0.4)"),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.beginPath(),t.arc(s,l,v,0,2*Math.PI),t.fill()},[g,v]),k=throttle(_,50);(0,l.useEffect)(()=>{let e=u.current,a=e.getContext("2d"),s=new Image;s.src=t,s.onload=()=>{a.drawImage(s,0,0,e.width,e.height)}},[t]),(0,l.useEffect)(()=>{let e=u.current;return e.addEventListener("touchstart",startDrawing,{passive:!1}),e.addEventListener("touchend",endDrawing,{passive:!1}),e.addEventListener("touchmove",k,{passive:!1}),()=>{e.removeEventListener("touchstart",startDrawing),e.removeEventListener("touchend",endDrawing),e.removeEventListener("touchmove",k)}},[k]);let startDrawing=e=>{e.preventDefault(),j(!0),p(!0),_(e)},endDrawing=()=>{p(!1);let e=u.current.getContext("2d");e.beginPath()},exportCanvas=async()=>{let e=u.current,t=e.toDataURL("image/png",1);console.log(t);let s=document.createElement("canvas");s.width=2*e.width,s.height=2*e.height;let l=s.getContext("2d");l.globalCompositeOperation="source-over";let r=new Image;r.src=t,await new Promise((e,t)=>{r.onload=e,r.onerror=t}),l.drawImage(r,0,0,s.width,s.height),l.globalCompositeOperation="destination-over";let i=new Image;i.src=a,await new Promise((e,t)=>{i.onload=e,i.onerror=t}),l.drawImage(i,0,0,s.width,s.height);let n=s.toDataURL("image/png",5),o=await d(n,400);c(o),s.remove()},resetCanvas=async e=>{e.preventDefault(),e.stopPropagation();let a=u.current,s=a.getContext("2d");s.clearRect(0,0,a.width,a.height);let l=new Image;l.src=t,s.globalCompositeOperation="source-over",l.onerror=()=>{console.error("Failed to load image:",t)},await new Promise((e,t)=>{l.onload=e,l.onerror=t}),s.drawImage(l,0,0,a.width,a.height),f([])};return(0,s.jsx)("div",{children:(0,s.jsxs)("div",{style:{position:"relative",width:i,height:n},children:[(0,s.jsx)("img",{className:"".concat((null==m?void 0:m.human_image_storage_mode)==="example"?"":"ph-no-capture"),src:a,alt:"Background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0}}),(0,s.jsx)("canvas",{id:"eraseCanvas",ref:u,width:i,height:n,onMouseDown:startDrawing,onMouseUp:endDrawing,onMouseMove:k,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1}}),!y&&(0,s.jsx)("div",{className:"pointer-events-none absolute top-0 left-0 z-10 p-3 w-full h-full flex justify-center items-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center p-6 bg-black/50 rounded-lg",children:[(0,s.jsx)("div",{className:"cursor-pointer animate-bounce opacity-80 mx-auto continue-move-left",children:(0,s.jsx)(P.Z,{color:"white",size:40})}),(0,s.jsx)("p",{className:"text-white text-xs font-bold opacity-80 text-center mt-4",children:N.formatMessage({id:"eraseEditor.startErasing"})})]})}),(0,s.jsx)("div",{className:"absolute top-0 left-0 z-20 p-3",children:(0,s.jsx)("div",{onClick:()=>{o()},className:"border border-gray-200 rounded-full p-1 bg-white shadow-xl cursor-pointer",children:(0,s.jsx)(ep,{size:20})})}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 p-3 z-20 ",children:(0,s.jsxs)(b.z,{variant:"outline",className:"bg-white border border-gray-300 text-gray-800 px-4 py-2 rounded-full",onClick:e=>resetCanvas(e),children:[(0,s.jsx)(ex.Z,{className:"w-4 h-4 mr-1"}),N.formatMessage({id:"eraseEditor.reset"})]})}),(0,s.jsx)("div",{className:"absolute right-0 right-0 p-3 z-20",children:(0,s.jsx)("div",{className:"p-2 border bg-white rounded-full",onClick:e=>exportCanvas(e),children:(0,s.jsx)(L.Z,{strokeWidth:2,className:"w-4 h-4"})})})]})})}function Scene(e){let{baseImage:t,depthMap:a,segmentationMap:r,overlayImages:i,overlayOpacity:n,overlayScale:o,overlayRotation:d,setOverlayScale:c,setOverlayRotation:m,hintOutsideSegment:u,setHintOutsideSegment:g,setLoading:p,applyMultiplyEffect:x,setApplyMultiplyEffect:f,includeBase:v,setStartedDragging:w,textureLoading:y,setTextureLoading:b}=e,j=(0,l.useRef)(),N=(0,l.useRef)(),{size:_,camera:k}=(0,eo.D)(),[S,M]=(0,l.useState)({width:2,height:2}),[C,E]=(0,l.useState)(null),[z,U]=(0,l.useState)([0,0]),[D,I]=(0,l.useState)(1.4);(0,h.Z)();let[P,T]=(0,l.useState)(null);(0,l.useEffect)(()=>{i.length>0&&(T(i[0].uuid),i[0].uuid!==P&&U([0,0]))},[i]);let Z=(0,l.useRef)({isDragging:!1,startPosition:{x:0,y:0},startOffset:[0,0]});return((0,l.useRef)(null),(0,l.useEffect)(()=>{if(!t)return;let e=new Image;e.crossOrigin="anonymous",e.src=t,e.onload=()=>{let a=e.naturalWidth,s=e.naturalHeight;if(console.log("Image loaded for plane sizing:",{imageWidth:a,imageHeight:s,baseImage:t}),!a||!s){let e="Image loaded but has zero dimensions for the plane. Width: ".concat(a,", Height: ").concat(s);console.error(e),E(e);return}let l=a/s;M({width:2*l,height:2})},e.onerror=e=>{let a="Failed to load base image for the scene. Error: ".concat(e);console.error(a,t),E(a)}},[t]),(0,eo.F)(e=>{let{camera:t}=e;if(t.isOrthographicCamera&&S.width>0&&S.height>0){let e=S.width,a=S.height;(t.left!==-e/2||t.right!==e/2||t.top!==a/2||t.bottom!==-a/2)&&(t.left=-e/2,t.right=e/2,t.top=a/2,t.bottom=-a/2,t.near=.1,t.far=100,t.position.z=2.5,t.zoom=1,t.updateProjectionMatrix())}}),(0,l.useEffect)(()=>{var e;if(!t||!a||!r||!(null==i?void 0:null===(e=i[0])||void 0===e?void 0:e.cdnUrl))return;let s=i[0].height/i[0].width,l="black-and-white"===i[0].color_mode,c=new ec.TextureLoader;Promise.all([new Promise((e,a)=>{c.load(t,e,void 0,e=>a(Error("Failed to load base texture: ".concat(e.message))))}),new Promise((e,t)=>{c.load(a&&a.startsWith("data:")?a:"data:image/png;base64,".concat(a),e,void 0,e=>t(Error("Failed to load depth map: ".concat(e.message))))}),new Promise((e,t)=>{c.load(i[0].cdnUrl,e,void 0,e=>t(Error("Failed to load overlay texture: ".concat(e.message))))}),new Promise((e,t)=>{c.load(r&&r.startsWith("data:")?r:"data:image/png;base64,".concat(r),e,void 0,e=>t(Error("Failed to load segmentation map: ".concat(e.message))))})]).then(e=>{let[t,a,r,i]=e;t.minFilter=ec.LinearFilter,t.magFilter=ec.LinearFilter,a.minFilter=ec.LinearFilter,a.magFilter=ec.LinearFilter,r.minFilter=ec.LinearFilter,r.magFilter=ec.LinearFilter,i.minFilter=ec.LinearFilter,i.magFilter=ec.LinearFilter;let c=new ec.ShaderMaterial({uniforms:{baseTexture:{value:t},depthMap:{value:a},overlayTexture:{value:r},segmentationMap:{value:i},depthStrength:{value:.3},maxDepthOpaque:{value:0},overlayScale:{value:o},overlayRotation:{value:d},overlayOffset:{value:new ec.Vector2(...z)},depthMapResolution:{value:new ec.Vector2(512,512)},perspectiveK:{value:D},overlayOpacity:{value:n},overlayAspectRatio:{value:.7*s},hintOutsideSegment:{value:u},applyMultiplyEffect:{value:x},includeBase:{value:v},overlayBlackAndWhite:{value:l},overlayContrast:{value:1.3}},vertexShader:"\n        varying vec2 vUv;\n        varying vec3 vNormal;\n        uniform sampler2D depthMap;\n        uniform float depthStrength;\n        uniform vec2 depthMapResolution;\n        void main() {\n          vUv = uv;\n\n          // Sample depth at center and neighbors\n          float dC = texture2D(depthMap, uv).r;\n          float dL = texture2D(depthMap, uv + vec2(-1.0 / depthMapResolution.x, 0.0)).r;\n          float dR = texture2D(depthMap, uv + vec2(1.0 / depthMapResolution.x, 0.0)).r;\n          float dU = texture2D(depthMap, uv + vec2(0.0, 1.0 / depthMapResolution.y)).r;\n          float dD = texture2D(depthMap, uv + vec2(0.0, -1.0 / depthMapResolution.y)).r;\n\n          // Compute normal from depth differences\n          vec3 dx = vec3(2.0 / depthMapResolution.x, 0.0, (dR - dL) * depthStrength);\n          vec3 dy = vec3(0.0, 2.0 / depthMapResolution.y, (dU - dD) * depthStrength);\n          vec3 normal = normalize(cross(dx, dy));\n          vNormal = normal;\n\n          // Displace position along Z only to avoid shattering\n          vec3 displaced = position + vec3(0.0, 0.0, dC * depthStrength);\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(displaced, 1.0);\n        }\n      ",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D baseTexture;\n        uniform sampler2D overlayTexture;\n        uniform sampler2D segmentationMap;\n        uniform sampler2D depthMap;\n        uniform float overlayScale;\n        uniform float overlayRotation;\n        uniform vec2 overlayOffset;\n        uniform float perspectiveK;\n        uniform float overlayOpacity;\n        uniform float overlayAspectRatio;\n        uniform float hintOutsideSegment;\n        uniform bool applyMultiplyEffect;\n        uniform bool includeBase;\n        uniform sampler2D eraseMap;\n        uniform bool showEraseEffect;\n        uniform bool overlayBlackAndWhite;\n        uniform float overlayContrast;\n        void main() {\n          // Adjust centeredUv to account for overlayOffset\n          vec2 centeredUv = vUv - 0.5;\n\n          // Apply perspective scaling first\n          float depth = texture2D(depthMap, vUv).r;\n          // Invert the depth to make closer objects larger and further objects smaller\n          float perspectiveScale = 1.0 / (1.0 + perspectiveK * depth);\n          vec2 perspectiveUv = centeredUv * perspectiveScale;\n\n          // Translate to origin, then rotate and scale\n          vec2 translatedUv = perspectiveUv - overlayOffset;\n\n          // Rotate the UV coordinates\n          float cosTheta = cos(-overlayRotation);\n          float sinTheta = sin(-overlayRotation);\n          vec2 rotatedUv = vec2(\n            translatedUv.x * cosTheta - translatedUv.y * sinTheta,\n            translatedUv.x * sinTheta + translatedUv.y * cosTheta\n          );\n\n          // Apply scaling after rotation\n          vec2 scaledUv = vec2(rotatedUv.x * overlayAspectRatio, rotatedUv.y);\n          vec2 finalUv = scaledUv * (1.0 / overlayScale) + 0.5;\n\n          vec4 overlay = vec4(0.0);\n          if (finalUv.x >= 0.0 && finalUv.x <= 1.0 && finalUv.y >= 0.0 && finalUv.y <= 1.0) {\n            overlay = texture2D(overlayTexture, finalUv);\n          }\n          overlay.a *= overlayOpacity;\n\n          // Convert overlay to grayscale if needed\n          if (overlayBlackAndWhite) {\n            float gray = dot(overlay.rgb, vec3(0.299, 0.587, 0.114));\n            overlay.rgb = vec3(gray);\n          }\n\n          // Apply contrast\n          overlay.rgb = (overlay.rgb - 0.5) * overlayContrast + 0.5;\n\n          vec4 base = vec4(0.0);\n          if (includeBase) {\n            base = texture2D(baseTexture, vUv);\n          }\n          vec4 seg = texture2D(segmentationMap, vUv);\n          float mask = seg.a;\n          vec3 finalColor = overlay.rgb; // Default to overlay color\n\n          if (showEraseEffect && includeBase) {\n            vec4 erase = texture2D(eraseMap, vUv);\n            overlay.a *= (1.0 - erase.a); // Apply erase effect based on black pixels\n          }\n\n          if (includeBase) {\n            vec3 multiplied = base.rgb * overlay.rgb;\n            finalColor = mix(base.rgb, applyMultiplyEffect ? multiplied : overlay.rgb, overlay.a * (mask > 0.0 ? mask : hintOutsideSegment));\n          }\n\n          gl_FragColor = vec4(finalColor, includeBase ? base.a : (overlay.a * (mask > 0.0 ? mask : hintOutsideSegment))); // Use overlay alpha\n        }\n      ",transparent:!0});N.current=c,b(!1)}).catch(e=>{let t="Error loading textures: ".concat(e.message);console.error(t),E(t)})},[t,a,r,i]),(0,l.useEffect)(()=>{let e=document.querySelector(".three-d-try-on-widget-canvas canvas");if(!e)return;let t=null,a=null,handleStart=s=>{if(s.touches&&s.touches.length>1){let[e,l]=s.touches;t=Math.hypot(l.clientX-e.clientX,l.clientY-e.clientY),a=Math.atan2(l.clientY-e.clientY,l.clientX-e.clientX);return}w(!0);let l=s.target;if(l!==e)return;g(.55);let r=s.touches?s.touches[0].clientX:s.clientX,i=s.touches?s.touches[0].clientY:s.clientY;Z.current.isDragging=!0,Z.current.startPosition={x:r,y:i},Z.current.startOffset=[...z]},handleMove=e=>{if(e.touches&&e.touches.length>1){let[s,l]=e.touches,r=Math.hypot(l.clientX-s.clientX,l.clientY-s.clientY),i=Math.atan2(l.clientY-s.clientY,l.clientX-s.clientX);if(null!==t){let e=r/t;c(t=>Math.max(.01,t*e))}if(null!==a){let e=i-a;m(t=>t-e)}t=r,a=i;return}if(!Z.current.isDragging||!N.current)return;let s=e.touches?e.touches[0].clientX:e.clientX,l=e.touches?e.touches[0].clientY:e.clientY,r=(s-Z.current.startPosition.x)/window.innerWidth*1,i=(l-Z.current.startPosition.y)/window.innerHeight*1,n=[Z.current.startOffset[0]+r,Z.current.startOffset[1]-i];U(n),N.current.uniforms.overlayOffset.value.set(...n),e.preventDefault()},handleEnd=()=>{Z.current.isDragging=!1,g(0),t=null,a=null};return e.addEventListener("mousedown",handleStart),window.addEventListener("mousemove",handleMove),window.addEventListener("mouseup",handleEnd),e.addEventListener("touchstart",handleStart),window.addEventListener("touchmove",handleMove,{passive:!1}),window.addEventListener("touchend",handleEnd),()=>{e.removeEventListener("mousedown",handleStart),window.removeEventListener("mousemove",handleMove),window.removeEventListener("mouseup",handleEnd),e.removeEventListener("touchstart",handleStart),window.removeEventListener("touchmove",handleMove),window.removeEventListener("touchend",handleEnd)}},[z,d]),(0,l.useEffect)(()=>{N.current&&(N.current.uniforms.overlayScale.value=o,N.current.uniforms.overlayRotation.value=d,N.current.uniforms.overlayOffset.value.set(...z),N.current.uniforms.perspectiveK.value=D,N.current.uniforms.overlayOpacity.value=n,N.current.uniforms.hintOutsideSegment.value=u,N.current.uniforms.applyMultiplyEffect.value=x,N.current.uniforms.includeBase.value=v,N.current.uniforms.overlayBlackAndWhite.value="black-and-white"===i[0].color_mode)},[o,d,z,D,n,u,x,v,i]),C)?(alert("An error occurred in the 3D scene: ".concat(C)),null):(0,s.jsxs)("mesh",{ref:j,children:[(0,s.jsx)("planeGeometry",{args:[S.width,S.height,300,300]}),N.current&&(0,s.jsx)("shaderMaterial",{attach:"material",args:[N.current]})]})}a(5663);let downloadOrShare=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tatship_3d_try_on_result.png";if(navigator.userAgent.includes("Mobile")){(0,V.u5)(e,t,"Check out my 3D Tattoo Try On!\nCreated with https://tatship.com");return}{let a=document.createElement("a");a.href=e,a.download=t,a.click(),a.remove();return}},addWatermark=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:160;return new Promise((a,s)=>{let l=new Image;l.crossOrigin="anonymous",l.src="https://static.tatship.com/application/try_on_watermark_v2.png",l.onload=()=>{let r=l.height/l.width*t,i=document.createElement("canvas"),n=i.getContext("2d"),o=new Image;o.crossOrigin="anonymous",o.src=e,o.onload=()=>{i.width=o.width,i.height=o.height,n.drawImage(o,0,0);let e=i.height-r-10;n.drawImage(l,16,e,t,r);let s=i.toDataURL("image/png",1);a(s)},o.onerror=()=>{s("Failed to load base image")}},l.onerror=()=>{s("Failed to load watermark image")}})},exportSceneAsPNG=async e=>{let{setLoading:t,mode:a="full"}=e,s=await new Promise((e,s)=>{try{"full"===a&&((0,er.L)("3d_try_on_export"),t(!0));let l=document.querySelector(".three-d-try-on-widget-canvas");if(!l){console.error("Canvas container not found");return}let r=l.querySelector("canvas");if(!r){console.error("WebGL canvas not found");return}let i=document.createElement("canvas");i.width=r.width*window.devicePixelRatio,i.height=r.height*window.devicePixelRatio;let n=i.getContext("2d");if(!n){console.error("Failed to get 2D context"),s(Error("Failed to get 2D context"));return}requestAnimationFrame(()=>{n.drawImage(r,0,0,r.width*window.devicePixelRatio,r.height*window.devicePixelRatio);let s=new Image;s.crossOrigin="anonymous",s.src="https://static.tatship.com/application/try_on_watermark_v2.png",s.onload=async()=>{let l=window.devicePixelRatio||1,r=260*l,o=s.height/s.width*r,d=i.height-o-10*l;if("get-data-url"===a){e(i.toDataURL("image/png"));return}n.drawImage(s,16*l,d,r,o),await new Promise(e=>setTimeout(e,1e3));let c=i.toDataURL("image/png");downloadOrShare(c),"full"===a&&t(!1)},s.onerror=()=>{console.error("Failed to load watermark image"),"full"===a&&t(!1)}})}catch(e){console.error("Error exporting scene as PNG:",e),t(!1),s(e)}});return s};function ThreeDimensionalTryOnWidget(e){var t;let[a,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)(!0),[d,c]=(0,l.useState)(null),[m,u]=(0,l.useState)(e.opacity||.55),[p,x]=(0,l.useState)(.15),[f,w]=(0,l.useState)(0),[y,N]=(0,l.useState)(null),[_,S]=(0,l.useState)(null),[M,E]=(0,l.useState)(null),[z,U]=(0,l.useState)(null),[D,T]=(0,l.useState)({width:e.width||"400px",height:e.height||"600px"}),[Z,O]=(0,l.useState)(.9),[R,F]=(0,l.useState)(e.trial.tattoo_imgs.map(e=>e.uuid)),[A,W]=(0,l.useState)(!0),[q,H]=(0,l.useState)(!0),[G,X]=(0,l.useState)({}),[Y,J]=(0,l.useState)(null),[K,Q]=(0,l.useState)(!1),[$,ee]=(0,l.useState)(null),[es,er]=(0,l.useState)(0),[ei,en]=(0,l.useState)(null),[eo,ec]=(0,l.useState)(!1),[ex,ef]=(0,l.useState)(!0),ev=(0,g.useRouter)(),ew=(0,h.Z)();(0,l.useEffect)(()=>{if(e.trial.tattoo_imgs){let t=e.trial.tattoo_imgs.find(e=>!R.includes(e.uuid));t&&(setNewOverlay(t),ec(!1)),F(e.trial.tattoo_imgs.map(e=>e.uuid))}},[e.trial]);let getImageMetadata=e=>new Promise((t,a)=>{let s=new Image;s.crossOrigin="anonymous",s.onload=()=>{let{width:e,height:a}=s;t({width:e,height:a})},s.onerror=a,s.src=e}),fetchInfo=async()=>{try{var t,a;o(!0);let s=window.localStorage.getItem("humanImgUrl");if(!(null===(t=e.trial.img_obj)||void 0===t?void 0:t.cdnUrl)&&!(null==s?void 0:s.startsWith("data:image")))try{s=el().AES.decrypt(s,e.decryptionKey).toString(el().enc.Utf8)}catch(t){if(console.error("Error decrypting human image URL:",t),e.onHumanImageUpload){e.onHumanImageUpload();return}}if((null===(a=e.trial.img_obj)||void 0===a?void 0:a.cdnUrl)&&(s=e.trial.img_obj.cdnUrl),N(s),S(s),window.tatship3DCacheInfo)c(window.tatship3DCacheInfo);else{let t=await r.Z.post("/trial/info-sync/".concat(e.trial_id),{base_data:s});c(t.data);let a=(0,V.qW)(t.data.e,e.trial.info_token);E(a),updateSize(s),window.tatship3DCacheInfo=t.data}let l=await getImageMetadata(e.trial.tattoo_imgs[0].cdnUrl);U([{...e.trial.tattoo_imgs[0],...l}])}catch(e){console.error("Error fetching trial info:",e)}finally{o(!1)}};(0,l.useEffect)(()=>{fetchInfo()},[]),(0,l.useEffect)(()=>{if(z&&z[0].width){let e=z[0].width;x(.15*(800/e))}},[z]);let updateSize=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t&&!y)return;let a=new Image;a.crossOrigin="anonymous",a.src=y||t,a.onload=()=>{let t=a.width/a.height,s=window.innerWidth<=768,l=e.width||window.innerWidth*(s?.88:.8),r=e.height||.8*window.innerHeight,i=l,n=l/t;n>r&&(n=r,i=r*t),T({width:"".concat(i,"px"),height:"".concat(n,"px")})}},[ey,eb]=(0,l.useState)(0),[ej,eN]=(0,l.useState)("position"),mergeSnapshotsIntoImg=async e=>{let{currentSnapshot:t,uuid:a,eraseMap:s}=e,l=document.createElement("canvas"),r=l.getContext("2d"),i=new Image;for(let[e,s]of(i.crossOrigin="anonymous",i.src=_,await new Promise(e=>{i.onload=e}),l.width=i.width,l.height=i.height,r.drawImage(i,0,0),Object.entries(t)))if(e!==a){let e=new Image;e.crossOrigin="anonymous",e.src=s,await new Promise(t=>{e.onload=t}),r.globalCompositeOperation="multiply",r.drawImage(e,0,0,l.width,l.height)}if(s){let e=new Image;e.crossOrigin="anonymous",e.src=s,await new Promise(t=>{e.onload=t}),r.globalCompositeOperation="destination-out",r.drawImage(e,0,0,l.width,l.height)}r.globalCompositeOperation="destination-over",r.drawImage(i,0,0);let n=l.toDataURL();return l.remove(),n},setNewOverlay=async e=>{try{o(!0);let t=await exportOverlay({backgroundMode:!0,exportMode:"temp-store"});await new Promise(e=>setTimeout(e,1e3));let a=await mergeSnapshotsIntoImg({currentSnapshot:t,uuid:e.uuid});N(a);let s=await getImageMetadata(e.cdnUrl);U([{...e,...s}]),u(.55),x(.15),w(0),O(.9),await new Promise(e=>setTimeout(e,1500))}catch(e){console.error("Error setting new overlay:",e)}finally{o(!1)}},confirmErase=async e=>{let{eraseMap:t=null}=e;i(!0);let a=await exportOverlay({backgroundMode:!0,exportMode:"temp-store"});await new Promise(e=>setTimeout(e,1e3));let s=await mergeSnapshotsIntoImg({currentSnapshot:a,uuid:null,eraseMap:t});en(s),Q(!1),i(!1),eN("finished-erase")},openEraseEditor=async()=>{eN("erase");let e=await exportSceneAsPNG({setLoading:()=>{},mode:"get-data-url"});J(e),Q(!0)},openExportModal=async()=>{try{i(!0);let e=await exportSceneAsPNG({setLoading:()=>{},mode:"get-data-url"});J(e),await new Promise(e=>setTimeout(e,1500)),eN("export")}catch(e){console.error("Error opening export modal:",e)}finally{i(!1)}},exportOverlay=async t=>{let{backgroundMode:a=!1,exportMode:s=null}=t;try{a||i(!0),H(!1),"temp-store"===s?O(0):(u(0),O(1)),await new Promise(e=>setTimeout(e,1e3));let t=await exportSceneAsPNG({setLoading:i,mode:"get-data-url"});if("temp-store"===s){let a={...G,[z[0].uuid]:t};return X(a),H(!0),u(e.opacity),O(0),a}let l=new Image;l.crossOrigin="anonymous",l.src=t,await new Promise(e=>{l.onload=e});let r=document.createElement("canvas"),n=r.getContext("2d");r.width=l.width,r.height=l.height,n.drawImage(l,0,0);let o=n.getImageData(0,0,r.width,r.height),d=o.data,c=r.width,m=r.height,h=0,g=0;for(let e=0;e<r.height;e++)for(let t=0;t<r.width;t++){let a=d[(e*r.width+t)*4+3];a>0&&(t<c&&(c=t),e<m&&(m=e),t>h&&(h=t),e>g&&(g=e))}let p=h-c,x=g-m,f=c/r.width,v=m/r.height,w=p/r.width,y=x/r.height,b=document.createElement("canvas"),j=b.getContext("2d");b.width=p,b.height=x,j.drawImage(r,c,m,p,x,0,0,p,x);let N=b.toDataURL();window.currentMaterialUrl=z[0].cdnUrl,e.onOverlayExport({dataUrl:N,originalUrl:z[0].cdnUrl,topLeftXPercent:f,topLeftYPercent:v,widthPercent:w,heightPercent:y,canvasWidth:r.width,canvasHeight:r.height}),H(!0),u(e.opacity),O(0),a||i(!1)}catch(t){console.error("Error exporting overlay:",t),e.onOverlayExport(null)}},disable3D=()=>{i(!0);let e=new URL(window.location.href);e.searchParams.delete("use3D");let t=e.toString();(0,V.q_)(t)},e_=(0,s.jsx)(s.Fragment,{children:"from_preset"!==e.trial.trial_source&&(0,s.jsxs)("div",{className:"p-3 flex gap-4 justify-center bg-white rounded-lg shadow-obvious w-full mt-4 lg:p-6 lg:rounded-l-full lg:rounded-r-none",children:[(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("div",{className:"flex items-center rounded-full bg-white p-2 px-3",children:[(0,s.jsx)(ea.r,{className:"data-[state=checked]:bg-teal-500 mr-2",id:"switch3d",checked:!0,onCheckedChange:e=>{disable3D()}}),(0,s.jsx)(et._,{onClick:()=>{disable3D()},className:"text-sm font-semibold cursor-pointer",children:"3D"})]})}),(0,s.jsxs)(b.z,{className:"w-full max-w-[300px] rounded-full",onClick:()=>{(0,V.q_)("/".concat(ev.locale,"/tattoo/try"))},children:[ew.formatMessage({id:"page.tatPage.createNewTryOn"}),(0,s.jsx)(j.Z,{className:"ml-2",size:14})]})]})});return(0,s.jsxs)("div",{className:"try-on-widget-container relative bg-gradient-light p-4",children:[(n||ex)&&(0,s.jsx)("div",{className:"z-50 try-on-widget-loading absolute top-0 left-0 w-full h-full flex justify-center bg-white/95",children:(0,s.jsxs)("div",{className:"mt-48 lg:mt-64 animate-pulse",children:[(0,s.jsx)("div",{className:"loader mx-auto mb-4 text-gray-600"}),(0,s.jsx)("div",{className:"text-base text-neutral-600 font-semibold tracking-tighter",children:"3D Try-On Preparing..."})]})}),a&&(0,s.jsx)("div",{className:"z-50 try-on-widget-loading absolute top-0 left-0 w-full h-full flex justify-center bg-white/95",children:(0,s.jsxs)("div",{className:"mt-48 lg:mt-64 animate-pulse",children:[(0,s.jsx)("div",{className:"loader-2 mx-auto mb-12 text-gray-600"}),(0,s.jsx)("div",{className:"text-base text-neutral-600 font-semibold tracking-tighter",children:"Processing..."})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-2",children:z&&(0,s.jsxs)("div",{className:"flex items-center bg-white shadow-obvious rounded-lg overflow-hidden relative",children:[["erase","finished-erase"].includes(ej)&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white/80 z-10"}),(0,s.jsx)("div",{className:"flex items-center gap-2 max-w-[300px] min-w-[280px] overflow-x-auto inner-shadow p-2 bg-gray-100",children:e.trial.tattoo_imgs.map((e,t)=>(0,s.jsx)("div",{className:"flex-shrink-0 rounded-lg cursor-pointer shadow-obvious bg-white ".concat(z[0].uuid===e.uuid?"border-4 border-gradient":""),style:{borderRadius:"10px"},onClick:async()=>{await setNewOverlay(e)},children:(0,s.jsx)("img",{src:e.cdnUrl,alt:e.uuid,className:" ".concat("black-and-white"===e.color_mode?"grayscale":""," p-1 w-12 h-12 object-contain")})},t))}),(0,s.jsx)("div",{className:"p-3",children:(0,s.jsx)("div",{className:"text-xs rounded-lg bg-white shadow-obvious cursor-pointer",onClick:()=>{eb(ey+1)},children:(0,s.jsx)("div",{className:"text-black p-2",children:(0,s.jsx)(k.Z,{strokeWidth:3,size:18})})})})]})}),(0,s.jsx)(v.Z,{setUserCredits:e.setGenerationCredits,setUser:e.setUser,merchant:e.merchant,merchantConfig:e.merchantConfig,open:ey,queryFileId:e.queryFileId,tryonTarget:e.tryonTarget,preset:e.preset,onSuccess:t=>{e.setUser(t.user),e.setGenerationCredits(t.user.tatship_generation_credits)},user:e.user,styles:e.styles,shapes:e.shapes,presetId:e.trial.preset_id,forMerchant:!!e.trial.merchant_id,generationCredits:e.generationCredits,className:"w-full text-xs my-auto",onChange:t=>{e.addImgs(t.files)},hideButton:!0})]}),"export"===ej&&(0,s.jsx)("div",{className:"fixed z-30 bottom-0 left-0 right-0 p-6 flex items-center justify-center ",children:(0,s.jsxs)("div",{className:"shadow-obvious w-full lg:max-w-[400px] bg-white rounded-lg p-4 relative",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 z-20 p-2",children:(0,s.jsx)("div",{onClick:()=>{eN("position")},className:"p-1 bg-white cursor-pointer",children:(0,s.jsx)(C.Z,{size:20})})}),(0,s.jsx)("div",{className:"text-sm font-semibold tracking-tighter mr-2 py-3",children:ew.formatMessage({id:"threeDWidget.exportImgs"})}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)("div",{className:"flex items-center gap-2 w-full rounded-lg overflow-x-auto inner-shadow p-2 bg-gray-100",children:e.trial.tattoo_imgs.map((e,t)=>(0,s.jsxs)("div",{className:"flex-shrink-0 rounded-lg cursor-pointer shadow-obvious bg-white",style:{borderRadius:"10px"},onClick:async()=>{try{i(!0);let t="tattoo-img-"+e.uuid+("black-and-white"===e.color_mode?"-grayscale":"")+".png";downloadOrShare(await (0,V.y5)({imageUrl:e.cdnUrl,greyscale:"black-and-white"===e.color_mode}),t)}catch(e){console.error("Error loading 3D try-on:",e)}finally{i(!1)}},children:[(0,s.jsx)("img",{src:e.cdnUrl,alt:e.uuid,className:" ".concat("black-and-white"===e.color_mode?"grayscale":""," p-1 w-16 h-16 object-contain")}),(0,s.jsx)("div",{className:"w-full flex items-center justify-center py-1 text-gray-700 border-t",children:(0,s.jsx)(L.Z,{color:"gray",size:16})})]},t))})}),(0,s.jsx)("div",{className:"py-3",children:(0,s.jsx)("h5",{className:"text-sm font-semibold tracking-tighter",children:ew.formatMessage({id:"threeDWidget.exportScene"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("img",{src:Y,alt:"fullSnapshot",className:"bg-gradient-light rounded-lg w-full object-conatin h-56 object-contain ".concat((null==e?void 0:null===(t=e.trial)||void 0===t?void 0:t.human_image_storage_mode)==="example"?"":"ph-no-capture")})}),(0,s.jsx)("div",{className:"p-3 ",children:(0,s.jsxs)(b.z,{onClick:()=>{exportSceneAsPNG({setLoading:i,mode:"full"})},variant:"outline",className:"border-black rounded-full font-semibold w-full",children:[ew.formatMessage({id:"threeDWidget.exportSceneButtonText"})," ",(0,s.jsx)(L.Z,{className:"ml-1",size:16})]})})]})]})}),"opacity"===ej&&(0,s.jsx)("div",{className:"fixed z-30 bottom-0 left-0 right-0 p-6 flex items-center justify-center ",children:(0,s.jsxs)("div",{className:"shadow-obvious w-full lg:max-w-[400px] flex items-center justify-center bg-white rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm font-semibold tracking-tighter mr-2",children:ew.formatMessage({id:"threeDWidget.opacity"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>u(e=>Math.min(1,e+.05)),children:(0,s.jsx)(B.Z,{size:16})}),(0,s.jsxs)("span",{className:"text-sm font-semibold",children:[Math.round((1-m)*100),"%"]}),(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>u(e=>Math.max(0,e-.05)),children:(0,s.jsx)(k.Z,{size:16})})]}),(0,s.jsx)("div",{className:"text-xs pl-2",children:(0,s.jsx)(b.z,{onClick:()=>eN("position"),className:"rounded-xl ml-2 font-semibold",children:ew.formatMessage({id:"threeDWidget.confirm"})})})]})}),"size"===ej&&(0,s.jsx)("div",{className:"fixed z-50 bottom-0 left-0 right-0 p-6 flex items-center justify-center ",children:(0,s.jsxs)("div",{className:"shadow-obvious w-full lg:max-w-[300px] bg-white rounded-lg p-2 px-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("div",{className:"text-sm font-semibold tracking-tighter mr-2",children:ew.formatMessage({id:"threeDWidget.size"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>x(Math.max(.01,p-.01)),children:(0,s.jsx)(B.Z,{size:16})}),(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>x(p+.005),children:(0,s.jsx)(k.Z,{size:16})})]}),(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(b.z,{onClick:()=>eN("position"),className:"rounded-xl ml-2 font-semibold",children:ew.formatMessage({id:"threeDWidget.confirm"})})})]}),(0,s.jsx)("div",{className:"text-xs text-gray-700 p-2 rounded-full bg-blue-50 text-blue-800 text-center mt-2 lg:hidden",children:ew.formatMessage({id:"threeDWidget.youCanScaleBy"})})]})}),"rotation"===ej&&(0,s.jsx)("div",{className:"fixed z-50 bottom-0 left-0 right-0 p-6 flex items-center justify-center ",children:(0,s.jsxs)("div",{className:"shadow-obvious w-full lg:max-w-[300px] bg-white rounded-lg p-2 px-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("div",{className:"text-sm font-semibold tracking-tighter mr-2",children:ew.formatMessage({id:"threeDWidget.rotation"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>w(f+.06),children:(0,s.jsx)(em.Z,{size:16})}),(0,s.jsx)("button",{className:"bg-white text-gray-700 px-2 py-2 rounded-md border",onClick:()=>w(f-.06),children:(0,s.jsx)(eu.Z,{size:16})})]}),(0,s.jsx)("div",{className:"text-xs pl-auto",children:(0,s.jsx)(b.z,{onClick:()=>eN("position"),className:"rounded-xl ml-2 font-semibold",children:ew.formatMessage({id:"threeDWidget.confirm"})})})]}),(0,s.jsx)("div",{className:"text-xs text-gray-700 p-2 rounded-full bg-blue-50 text-blue-800 text-center mt-2 lg:hidden",children:ew.formatMessage({id:"threeDWidget.youCanRotateBy"})})]})}),(0,s.jsx)("div",{className:"hidden lg:block fixed top-16 right-0 z-20",children:e_}),(0,s.jsx)("div",{style:{width:"100%",height:e.height||"100vh",position:"relative",display:"flex",justifyContent:"center"},children:(0,s.jsxs)("div",{style:{...D,background:"#222",margin:0,padding:0,overflow:"hidden",touchAction:"none",position:"relative"},className:"rounded-2xl shadow-xl border relative three-d-try-on-widget-canvas",children:[K&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-50",children:(0,s.jsx)(EraserMap,{trial:e.trial,downloadOrShare:downloadOrShare,addWatermark:addWatermark,onClose:()=>{Q(!1),eN("position")},width:D.width,height:D.height,backgroundImage:_,currentFullSnapshot:Y,onExport:async e=>{i(!0),ee(e),Q(!1),await confirmErase({eraseMap:e})}})}),!eo&&(0,s.jsx)("div",{className:"pointer-events-none absolute top-0 left-0 z-10 p-3 w-full h-full flex justify-center items-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center p-6 bg-black/50 rounded-lg",children:[(0,s.jsx)("div",{className:"lg:cursor-pointer animate-bounce opacity-80 mx-auto continue-move-left",children:(0,s.jsx)(eh,{className:"rotate-45",color:"white",size:40})}),(0,s.jsx)("p",{className:"text-white text-xs font-bold opacity-80 text-center mt-4",children:ew.formatMessage({id:"eraseEditor.startDragging"})})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap justify-center pt-3 fixed bottom-0 left-0 right-0 px-2 py-4 lg:p-6 z-30 w-full ".concat("position"===ej?"":"hidden"),children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 z-20",children:[(0,s.jsxs)("div",{className:"flex items-center bg-white text-gray-700 text-xs lg:text-sm font-semibold tracking-tighter px-3 py-2 rounded-full cursor-pointer shadow-obvious",onClick:()=>eN("opacity"),children:[(0,s.jsx)(eg,{className:"",size:16}),(0,s.jsx)("span",{className:"ml-1",children:ew.formatMessage({id:"threeDWidget.opacity"})})]}),(0,s.jsxs)("div",{className:"flex items-center bg-white text-gray-700 text-xs lg:text-sm font-semibold tracking-tighter px-3 py-2 rounded-full cursor-pointer shadow-obvious",onClick:()=>eN("size"),children:[(0,s.jsx)(I,{className:"mr-1",size:16}),"  ",ew.formatMessage({id:"threeDWidget.size"})]}),(0,s.jsxs)("div",{className:"flex items-center bg-white text-gray-700 text-xs lg:text-sm font-semibold tracking-tighter px-3 py-2 rounded-full cursor-pointer shadow-obvious",onClick:()=>eN("rotation"),children:[(0,s.jsx)(eu.Z,{className:"mr-1",size:16})," ",ew.formatMessage({id:"threeDWidget.rotation"})]}),(0,s.jsxs)("div",{className:"flex items-center bg-white text-gray-700 text-xs lg:text-sm font-semibold tracking-tighter px-3 py-2 rounded-full cursor-pointer shadow-obvious",onClick:()=>{openEraseEditor()},children:[(0,s.jsx)(P.Z,{className:"",size:16}),(0,s.jsx)("span",{className:"ml-1 hidden lg:block",children:ew.formatMessage({id:"threeDWidget.erase"})})]})]}),(0,s.jsx)("div",{className:"block lg:hidden w-full",children:e_})]}),(0,s.jsx)("div",{className:"absolute top-1 right-1 p-2 z-20",children:(0,s.jsx)("div",{className:"flex items-center mb-3 bg-white text-gray-700 text-sm font-semibold tracking-tighter px-2 py-2 rounded-full cursor-pointer shadow-xl",onClick:()=>{openExportModal(),(0,V.Gz)()},children:(0,s.jsx)(L.Z,{className:"",size:16})})}),d&&z&&D.width&&D.height&&(0,s.jsx)(ed.Xz,{orthographic:!0,camera:{position:[0,0,2.5],near:.1,far:100,zoom:1},style:{marginLeft:"auto",marginRight:"auto",width:"100%",height:"100%",display:"block",margin:0,padding:0,touchAction:"none"},children:(0,s.jsx)(Scene,{baseImage:y,depthMap:(0,V.qW)(d.p,e.trial.info_token),segmentationMap:M,overlayImages:z,overlayOpacity:1-m,overlayScale:p,overlayRotation:f,setOverlayScale:x,setOverlayRotation:w,hintOutsideSegment:Z,setHintOutsideSegment:O,setLoading:i,applyMultiplyEffect:A,setApplyMultiplyEffect:W,includeBase:q,showEraseEffect:es,setStartedDragging:ec,textureLoading:ex,setTextureLoading:ef})}),"finished-erase"===ej&&(0,s.jsx)("div",{className:"absolute top-0 left-0 z-20 p-3",children:(0,s.jsx)("div",{onClick:async()=>{},className:"border border-gray-200 rounded-full p-1 bg-white shadow-xl cursor-pointer",children:(0,s.jsx)(ep,{size:20})})}),"finished-erase"===ej&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-10",children:(0,s.jsx)("img",{src:ei,alt:"erasedResult",className:"w-6/12 h-6/12 object-contain"})})]})})]})}var ef=!0;function TrialPage(e){var t,a,i,p,E,K,es,eo,ed,ec,em,eu,eh,eg,ep,ex,ef,ev,ew,ey,eb,ej,eN,e_,ek,eS,eM,eC,eE,ez,eU,eD;let eI=(0,h.Z)(),checkNeedToPay=function(){var t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Date().getTime(),new Date(e.user.try_on_first_created_at).getTime(),"merchant_preset"!==e.user.user_source&&!(0,V.sj)()&&e.user.try_on_created_count>1&&"premium"!==e.user.user_tier&&"bought-credit"!==e.user.user_tier&&!((null===(t=a||eQ)||void 0===t?void 0:t.tattoo_imgs)||[]).every(e=>"from-url"===e.graphicMode)},[eP,eT]=(0,l.useState)(!1),[eZ,eL]=(0,l.useState)(!1),[eO,eR]=(0,l.useState)(!1),checkAndShowPaywall=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=checkNeedToPay(t);if(eT(a),a&&window.localStorage.setItem("paywall_triggered_by",e.user.user_id),(0,V.sj)()&&"free"===e.user.user_tier&&e.user.try_on_created_count>1){var s,l,i;(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.email.includes("tatship.com"))&&window.alert("App Debug: "+JSON.stringify(null==e?void 0:e.user));let t=await r.Z.get("/user/revenue-cat/current");if((null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.email.includes("tatship.com"))&&window.alert(JSON.stringify(t.data)),(null==t?void 0:null===(i=t.data)||void 0===i?void 0:i.user_tier)!=="free")return;(0,V.Dl)(!0);return}setTimeout(()=>{eL(!0)},200)};(0,l.useEffect)(()=>{if((0,V.sj)()){let handleMessage=e=>{try{let t=JSON.parse(e.data);if("PAYWALL_PAYMENT_SUCCESS"===t.type){let{data:e}=t.payload;console.log("Payment was successful:",e);let a=new URL(window.location.href);a.searchParams.set("refresh_time",new Date().getTime().toString()),(0,V.q_)(a.toString())}}catch(e){console.error("Error parsing message:",e)}};return window.addEventListener("message",handleMessage),(0,V.mC)("app_tattoo_try_on_started",{}),()=>{window.removeEventListener("message",handleMessage)}}},[]),(0,l.useEffect)(()=>{e.loginToken&&(0,V.BE)(e.loginToken),checkAndShowPaywall(),(0,V.b2)("LOADING_OFF",{})},[]);let{locale:eF,locales:eA,defaultLocale:eB,push:eW,query:eq}=(0,g.useRouter)(),eH=eq.embedMode||"none",eG=eq.file_id,eV=(0,g.useRouter)(),[eX,eY]=(0,l.useState)(!1),{user:eJ,setUser:eK}=(0,l.useContext)(d.V),[eQ,e$]=(0,l.useState)(e.trial),[e0,e1]=(0,l.useState)(!1),[e2,e3]=(0,l.useState)(!1),[e4,e5]=(0,l.useState)(!1),[e6,e8]=(0,l.useState)(!1),[e7,e9]=(0,l.useState)(!1),[te,tt]=(0,l.useState)(!1),[ta,ts]=(0,l.useState)(!1),[tl,tr]=(0,l.useState)(50),[ti,tn]=(0,l.useState)(0),[to,td]=(0,l.useState)(""),[tc,tm]=(0,l.useState)("multiply"),[tu,th]=(0,l.useState)(""),[tg,tp]=(0,l.useState)(""),[tx,tf]=(0,l.useState)(!1),[tv,tw]=(0,l.useState)(e.merchantConfig?e.merchantConfig.credits_available:e.user.tatship_generation_credits),[ty,tb]=(0,l.useState)(e.trial.tattoo_imgs[0].cdnUrl),tj=e.trial.paint_mode||"manual",[tN,t_]=(0,l.useState)({}),[tk,tS]=(0,l.useState)(!1),[tM,tC]=(0,l.useState)(!eP),[tE,tz]=(0,l.useState)(!1),[tU,tD]=(0,l.useState)(!1),[tI,tP]=(0,l.useState)(!1),[tT,tZ]=(0,l.useState)(!1),[tL,tO]=(0,l.useState)(!1),[tR,tF]=(0,l.useState)(null),[tA,tB]=(0,l.useState)(""),[tW,tq]=(0,l.useState)(!1),[tH,tG]=(0,l.useState)(!1),[tV,tX]=(0,l.useState)(!1),[tY,tJ]=(0,l.useState)(!1),[tK,tQ]=(0,l.useState)(!1),[t$,t0]=(0,l.useState)(!1),[t1,t2]=(0,l.useState)(!1),[t3,t4]=(0,l.useState)(!1),t5=(0,f.usePathname)(),t6=(null==t5?void 0:t5.includes("/jewellery/"))?"jewellery":"tattoo",[t8,t7]=(0,l.useState)(!1),[t9,ae]=(0,l.useState)(0),[at,aa]=(0,l.useState)(!1),[as,al]=(0,l.useState)(!1),[ar,ai]=(0,l.useState)(e.trial.merchant_id?null:"allow_switch");(0,l.useEffect)(()=>{window.tatshipShowing3D=e6},[e6]),(0,l.useEffect)(()=>{let handleRouteChange=()=>{window.location.reload()};return window.addEventListener("popstate",handleRouteChange),()=>{window.removeEventListener("popstate",handleRouteChange)}},[eV.asPath]);let toggleSelectedImage=e=>{let t=JSON.parse(JSON.stringify(tN));t[e.cdnUrl]?delete t[e.cdnUrl]:t[e.cdnUrl]=e,t_(t)},createDesign=async()=>{tf(!0),r.Z.post("/design/create",{createBody:{init_type:"for-temp-tattoo",trial_id:eQ.trial_id,layers:eQ.tattoo_imgs.filter(e=>!!tN[e.cdnUrl]).map(e=>({layer_id:(e.cdnUrl+Math.random()).toString(16),bg_preference:"transparent",file_info:e,chosen_file_info:e,bg_removed_file_info:e}))}}).then(e=>{console.log(e),(0,V.q_)("/".concat(eF,"/tattoo/design/").concat(e.data.design_id))}).catch(e=>{console.log(e)})},changeMode=e=>{let t=new CustomEvent("mode-change",{detail:{value:e}});te&&tt(!1),window.dispatchEvent(t),td(e)},[an,ao]=(0,l.useState)(null),[ad,ac]=(0,l.useState)(0);(0,l.useEffect)(()=>{e.user||eY(!0),e.user&&eK(e.user),(0,V.dh)()&&t4(!0),window.addEventListener("initial-tattoo-loaded",async t=>{var a;tC(!1),(null==e?void 0:null===(a=e.merchant)||void 0===a?void 0:a.merchant_id)||(changeMode("basic-position"),tE||tz(!0))}),window.addEventListener("dataurl-ready-for-display-export",async t=>{{var a;let s=t.detail.dataURL;["livebytheswordtattoo-demo","livebytheswordtattoo"].includes(null==e?void 0:null===(a=e.merchant)||void 0===a?void 0:a.merchant_id)&&(s=await addTattooFileInfo(s)),ao(s)}}),window.addEventListener("dataurl-ready-for-export",async t=>{{var a;let s=t.detail.dataURL;["livebytheswordtattoo-demo","livebytheswordtattoo"].includes(null==e?void 0:null===(a=e.merchant)||void 0===a?void 0:a.merchant_id)&&(s=await addTattooFileInfo(s)),(0,ei.l_)(s,"try_on_result.png")}}),window.addEventListener("shaped-added",e=>{e3(!1),e8(!1),e9(!1),changeMode("basic-position"),ac(new Date().getTime()),document.querySelector("body").style.overflow="scroll"}),window.addEventListener("decryption-error",e=>{console.log("decryption error"),tC(!1),tJ(!0)}),window.addEventListener("shaped-pre-added",async e=>{let t=new CustomEvent("remove-material",{detail:{url:window.currentMaterialUrl}});window.dispatchEvent(t)}),window.addEventListener("image-loaded",async e=>{"inpaint"===tj&&changeMode("mask")}),window.currentMaterialUrl=ty,setTimeout(()=>{e.trial.tattoo_imgs.forEach(e=>{let t=new CustomEvent("add-material",{detail:{url:e.cdnUrl}});window.dispatchEvent(t)})},5e3),(0,V.zd)()&&t0(!0),setTimeout(()=>{let t=document.querySelector(".konvajs-content canvas");t||e.use3D?console.log("script ready"):(console.log("script not ready, reloading"),window.location.reload())},6e3)},[]);let logPresetEvent=async t=>{try{var a,s,l;(0,er.L)("preset_book_click",{},{event_name:"preset_book_click",event_body:{merchant_id:null==e?void 0:null===(a=e.merchant)||void 0===a?void 0:a.merchant_id,preset_id:null==e?void 0:null===(s=e.preset)||void 0===s?void 0:s.preset_id,try_on_target:t6}}),(null==e?void 0:null===(l=e.preset)||void 0===l?void 0:l.preset_id)&&await r.Z.post("/preset/log-event",{preset_id:e.preset.preset_id,event_name:t})}catch(e){console.log(e)}},removeImg=async t=>{e3(!0);let a=await r.Z.post("/trial/update-for-client",{update_case:"remove_img",removeImgCdnUrl:t.cdnUrl,additional_img_file_obj:t,trial_id:e.trial.trial_id,element_id:t.element_id}),s=new CustomEvent("remove-material",{detail:{url:t.cdnUrl,element_id:t.element_id}});window.dispatchEvent(s),e$(a.data.doc),changeMode("basic-position"),setTimeout(()=>{e3(!1)},1e3)},[am,au]=(0,l.useState)(e.merchants||[]),addImgs=async t=>{e3(!0);for(let a=0;a<t.length;a++){let s=new Date().getTime(),l=t[a];l.element_id=s;let i=await r.Z.post("/trial/update-for-client",{update_case:"add_img",additional_img:l.cdnUrl,additional_img_file_obj:l,trial_id:e.trial.trial_id}),n=new CustomEvent("add-new-img",{detail:{url:l.cdnUrl,crop:"text"===l.graphicMode,metaData:l}});window.dispatchEvent(n);let o=new CustomEvent("add-material",{detail:{url:l.cdnUrl}});window.dispatchEvent(o),e$(i.data.doc),au(i.data.merchants),changeMode("basic-position"),setTimeout(()=>{checkAndShowPaywall(i.data.doc)},5e3)}setTimeout(()=>{e3(!1)},2e3)},generateInpaint=async()=>{tf(!0);let t=window.tatshipExportMaskB64();r.Z.post("/trial/inpaint",{prompt:tu,imageB64:window.init_img_b64.split(",")[1],maskB64:t.split(",")[1],width:512,height:768,trial_id:e.trial.trial_id}).then(e=>{window.replaceBaseImage(e.data.upload_resp.Location),tp(e.data.upload_resp.Location),tw(e.data.remaining_credits)}).catch(e=>{console.log(e)}).finally(()=>{tf(!1)})};(0,l.useEffect)(()=>{"jewellery"!==t6&&generateMaskJob()},[]);let ah=(0,s.jsxs)("div",{className:"flex flex-wrap",children:[(0,s.jsxs)("div",{className:"sm:w-8/12 w-full sm:p-4",children:[(0,s.jsx)("h5",{className:"text-sm font-bold mb-4",children:eI.formatMessage({id:"createTrialPage.generationPrompt"})}),(0,s.jsx)("textarea",{className:"border rounded-lg p-2 text-sm sm:mb-0 mb-3 w-full",rows:2,disabled:tx,value:tu,onChange:e=>th(e.target.value)})]}),(0,s.jsx)("div",{className:"sm:w-4/12 w-full sm:border-l sm:p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"w-7/12 p-2",children:(0,s.jsxs)("button",{disabled:tx,onClick:generateInpaint,className:"shadow-xl h-full rounded px-3 py-2 text-center text-white font-bold text-sm bg-teal-600 w-full",children:[tg?eI.formatMessage({id:"createTrialPage.generationAgainButtonText"}):eI.formatMessage({id:"createTrialPage.generationButtonText"}),(0,s.jsx)(m.G,{className:"ml-2",icon:u.UO1})]})}),(0,s.jsx)("div",{className:"w-5/12 cursor-pointer p-2",id:"open-export-frame-inpaint",onClick:()=>ts(!0),children:(0,s.jsxs)("div",{className:"px-4 py-2 border rounded-lg shadow-xl flex text-sm font-semibold justify-center",children:[(0,s.jsx)("img",{src:"https://asset.useai4work.com/tatship/application/download_icon.png",className:"w-4 h-4 mr-2 my-auto"})," ",eI.formatMessage({id:"createTrialPage.generationExportText"})]})})]})})]}),sourceInfoSection=e=>(0,s.jsx)("div",{children:!!(e.post_source_name&&e.post_url)&&(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h6",{className:"text-3xs text-gray-500 px-1",children:eI.formatMessage({id:"page.ideaPage.tryOnButton.author"})}),(0,s.jsx)("div",{className:"pb-2 flex pt-1",children:(0,s.jsxs)("a",{className:"text-3xs font-semibold flex items-center justify-center px-3 py-1 border border-gray-300 shadow rounded-full",href:e.post_url,target:"_blank",rel:"noreferrer nofollow",children:[e.post_url.includes("instagram")&&(0,s.jsx)(N.Z,{className:"w-4 h-4 mr-1"}),e.post_url.includes("pinterest")&&(0,s.jsx)("img",{src:"/assets/pinterest-logo.png",alt:"".concat(e.post_source_name," logo"),className:"w-4 h-4 object-contain mr-1"}),e.post_source_name]})})]})}),merchantInfoSection=e=>{var t,a;let l=null==e?void 0:e.merchant_main_website;return(0,s.jsx)("div",{children:(null==e?void 0:e.artist_name)&&(0,s.jsxs)("div",{className:"border-t border-gray-200 bg-white overflow-hidden rounded-b-lg",children:[(0,s.jsxs)("div",{className:"flex items-center p-2",children:[(null==e?void 0:null===(t=e.logo_image)||void 0===t?void 0:t.cdnUrl)&&(0,s.jsx)("img",{src:(null===(a=e.logo_image)||void 0===a?void 0:a.cdnUrl)+"-/resize/300x/",alt:null==e?void 0:e.artist_name,className:"shadow w-6 h-6 mr-2 rounded-full object-cover"}),(0,s.jsx)("div",{className:"text-2xs text-gray-500",children:null==e?void 0:e.artist_name})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-2 border-t border-gray-200",children:[(null==e?void 0:e.instagram_username)&&(0,s.jsxs)(Q(),{onClick:()=>{markClick({merchant_id:e.merchant_id,referral_type:"instagram",referral_location:"gallery"})},href:"https://instagram.com/".concat(e.instagram_username),target:"_blank",rel:"noopener noreferrer",className:"text-2xs text-gray-800 font-bold hover:underline flex items-center",children:[(0,s.jsx)(N.Z,{className:"mr-1",size:14}),"Instagram"]}),l&&(0,s.jsxs)(Q(),{onClick:()=>{markClick({merchant_id:e.merchant_id,referral_type:"website",referral_location:"gallery"})},href:l,target:"_blank",rel:"noopener noreferrer",className:"text-2xs text-gray-800  hover:underline flex items-center",children:[(0,s.jsx)(_.Z,{className:"mr-1",size:14}),"Website"]})]})]})})},ag=(0,s.jsx)("div",{className:"bg-white flex justify-center items-center shadow-obvious rounded-xl h-8 w-8",onClick:()=>ae(t9+1),children:(0,s.jsx)(k.Z,{className:"text-neutral-800",strokeWidth:3,size:18})}),downloadGalleryImageButton=t=>(0,s.jsx)("div",{className:"",children:("self-design"===t.graphicMode||"upload"===t.graphicMode||"generate"===t.graphicMode||"tatshiphq"===t.merchant_id)&&(0,s.jsxs)("button",{onClick:async()=>{try{if(console.log((0,V.s2)(e.headers)),(0,V.s2)(e.headers)){let e=await (0,V.Cn)(t.cdnUrl);(0,V.u5)(e,"tattoo_design.png","Check out my Tattoo Design!"+(av?"":"\nCreated with https://tatship.com"))}else(0,V.oj)(t.cdnUrl,t.file_name_local);(0,er.L)("tattoo_gallery_download_"+t.graphicMode,{})}catch(e){console.log(e)}},className:"flex items-center m-1 bg-white border border rounded text-xs text-gray-500 p-1",children:[(0,s.jsx)(S.Z,{className:"mr-1",size:14})," Save"]})}),ap=(0,s.jsx)("div",{className:"w-full lg:w-[300px] lg:fixed lg:z-20 lg:left-0 left-0 lg:top-32 bg-white bg-white shadow-xl border rounded-lg border-b flex-wrap mb-0",style:{zIndex:0},children:(0,s.jsxs)("div",{className:"flex justify-between lg:flex-wrap flex-nowrap",children:[(0,s.jsxs)("div",{className:"cursor-pointer w-full lg:block p-2 mr-auto",children:[(0,s.jsx)("div",{className:"lg:hidden",children:(0,s.jsxs)(en.x,{className:"w-full whitespace-nowrap shadow bg-gray-100 rounded-lg",children:[(0,s.jsx)("div",{className:"flex flex-nowrap overflow-x-scroll",children:eQ.tattoo_imgs.map((e,t)=>(0,s.jsx)("div",{className:"w-16 h-12 lg:h-20 lg:w-20 p-1",children:(0,s.jsx)("div",{onClick:()=>{tZ(!0),(0,er.L)("tattoo_gallery_click",{})},className:"rounded-lg border shadow-xl overflow-hidden relative w-full h-full",children:(0,s.jsx)("img",{className:"bg-white w-full h-full object-contain ".concat("black-and-white"===e.color_mode?"grayscale":""),src:e.cdnUrl})})},t))}),(0,s.jsx)(en.B,{orientation:"horizontal"})]})}),(0,s.jsxs)("div",{className:"lg:block hidden",children:[(0,s.jsxs)("div",{className:"p-2 py-3 flex justify-between items-center",children:[(0,s.jsx)("h5",{className:"text-xs text-gray-600",children:eI.formatMessage({id:"page.tatPage.mySelection"})}),(0,s.jsx)("div",{className:"",children:ag})]}),(0,s.jsx)("div",{className:"p-2 max-h-[280px] overflow-y-scroll shadow-inner bg-gray-100",children:eQ.tattoo_imgs.map((t,a)=>{let l=e.merchants.find(e=>e.merchant_id===t.merchant_id);return(0,s.jsxs)("div",{className:"p-2 shadow border mb-2 bg-white",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"border rounded-lg bg-slate-50 h-16 w-16 object-contain bg-contain bg-center bg-no-repeat mr-1 ".concat("black-and-white"===t.color_mode?"grayscale":""),style:{backgroundImage:"url(".concat(t.cdnUrl,")")}}),(0,s.jsxs)("div",{className:"p-2 w-full",children:["jewellery"===t6&&(0,s.jsx)("h5",{className:"text-xs text-gray-600 tracking-tighter mb-2",children:t.file_name_local||eI.formatMessage({id:"page.tatPage.".concat(t.graphicMode,"_design_default_name")})}),(0,s.jsxs)("div",{className:"flex items-center",children:[downloadGalleryImageButton(t),(0,s.jsx)("div",{className:"text-xs text-gray-500 mr-2 border p-1 rounded",onClick:()=>addImgs([t]),children:(0,s.jsx)(M.Z,{size:12})}),eQ.tattoo_imgs.length>1&&(0,s.jsx)("div",{className:"text-xs text-gray-500 border p-1 rounded",onClick:()=>removeImg(t),children:(0,s.jsx)(C.Z,{size:12})})]}),"popup"!==eH&&(0,s.jsx)("div",{className:"mt-2",children:merchantInfoSection(l)}),"popup"!==eH&&(0,s.jsx)("div",{className:"mt-2",children:sourceInfoSection(t)})]})]}),"from_preset"!==e.trial.trial_source&&["generate","upload","text","self-design","platform-gallery"].includes(t.graphicMode)&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)(b.z,{className:"text-3xs h-8 px-3 rounded-full w-full",onClick:()=>{tF(t),tO(!0)},children:[eI.formatMessage({id:"trialPage.orderTempTattoo"})," ",(0,s.jsx)(z,{className:"ml-1",size:14})]})})]},a)})})]})]}),(0,s.jsx)("div",{className:"p-3 flex items-center lg:hidden",children:ag})]})}),ax="",af="";if(e.merchant&&((null===(eS=e.merchant)||void 0===eS?void 0:eS.main_contact_method)==="whatsapp"&&(ax="https://wa.me/".concat(e.merchant.whatsapp_number),af="WhatsApp Us"),(null===(eM=e.merchant)||void 0===eM?void 0:eM.main_contact_method)==="email"&&(ax="mailto:".concat(e.merchant.email_address),af="Email Us"),(null===(eC=e.merchant)||void 0===eC?void 0:eC.main_contact_method)==="booking_form"&&(ax=e.merchant.booking_form_url,af=eI.formatMessage({id:"page.trypage.bookNow"})),(null===(eE=e.merchant)||void 0===eE?void 0:eE.main_contact_method)==="website"&&(ax=e.merchant.merchant_main_website,af=eI.formatMessage({id:"page.trypage.bookNow"})),(null===(ez=e.merchant)||void 0===ez?void 0:ez.main_contact_method)==="line"&&(ax=e.merchant.line_url,af="Chat in Line"),(null===(eU=e.merchant)||void 0===eU?void 0:eU.main_contact_method)==="ig-dm"&&(ax="https://instagram.com/".concat(e.merchant.instagram_username),af="DM us on Instagram"),e.trial.tattoo_imgs.length>0)){let t=e.trial.tattoo_imgs.find(e=>e.redirect_url);t&&(ax=t.redirect_url)}let generateMaskJob=async()=>{try{var t,a,s,l,i;if(null===(t=e.trial)||void 0===t?void 0:t.mask_url)return console.log("mask url available"),tB(null===(l=e.trial)||void 0===l?void 0:l.mask_url),null===(i=e.trial)||void 0===i?void 0:i.mask_url;let n=!1;try{let e=document.createElement("canvas");e.getContext("webgl")||e.getContext("experimental-webgl"),console.log("High performance device"),e.remove()}catch(e){console.log("Low performance device")}"undefined"!==window&&(n=n&&window.navigator.userAgent.includes("Mac OS"));let o="",d=window.localStorage.getItem("humanImgUrl");if((null===(a=e.trial.img_obj)||void 0===a?void 0:a.cdnUrl)||(null==d?void 0:d.startsWith("data:image"))||(d=el().AES.decrypt(d,e.decryptionKey).toString(el().enc.Utf8)),(null===(s=e.trial.img_obj)||void 0===s?void 0:s.cdnUrl)&&(d=await (0,V.Cn)(e.trial.img_obj.cdnUrl)),n&&!(0,V.s2)(e.headers))o=await (0,ee.s)({url:d});else{let{data:t}=await r.Z.post("/trial/generate-mask",{b64:d,trial_id:e.trial_id});o=t.maskUrl}if(o)return tB(o),o}catch(e){console.log(e)}},handleAIAutoErase=async e=>{let{backgroundMode:t=!1}=e;try{if(t||e3(!0),tW){tq(!1);let e=new CustomEvent("disable-ai-auto-erase",{detail:{url:""}});window.dispatchEvent(e),t||e3(!1);return}tq(!0),window.gtag("event","EnableAutoErase",{});let e=new CustomEvent("add-ai-auto-erase",{detail:{url:tA}});window.dispatchEvent(e),tB(tA),t||e3(!1)}catch(e){console.log(e),e3(!1)}},handleHumanImageUpload=t=>{e3(!0);let a=el().AES.encrypt(t,e.decryptionKey).toString();window.localStorage.setItem("humanImgUrl",a),r.Z.post("/trial/update-for-client",{update_case:"clear_mask",trial_id:e.trial.trial_id}).then(e=>{window.location.reload()}).catch(e=>{console.log(e)})};e.preset&&"/".concat(eF,"/").concat((null==t5?void 0:t5.includes("/preset-try/"))?"s":"artist","/").concat(null==e?void 0:null===(eD=e.preset)||void 0===eD?void 0:eD.merchant_id);let av=!1;(null==e?void 0:e.merchantConfig)&&(e.merchantConfig.features_allowed||[]).includes("remove_watermark")&&(av=!0);let addTattooFileInfo=async t=>{let a=await (0,V.ne)({imageDataUrl:t,text:"Flashes Chosen",subtitle:eQ.tattoo_imgs.filter(e=>"preset"===e.graphicMode).map(e=>e.fileInfo.originalFilename||e.file_name_local||"").join("\n"),qrText:"https://tatship.com/".concat(eF,"/tattoo/try/info/").concat(e.trial_id,"?st=").concat(e.trial.info_token)});return a},markClick=async t=>{console.log("mark click");try{await r.Z.post("/event/track",{event_name:"click_referral_tattoo_try",merchant_id:t.merchant_id,referral_type:t.referral_type,trial_id:e.trial_id,referral_location:t.referral_location})}catch(e){console.log(e)}};eI.formatMessage({id:"page.trypage.orderATempTattoo"}),eI.formatMessage({id:"page.trypage.orderATempTattooDesc"}),b.z,eI.formatMessage({id:"page.trypage.orderNow"}),j.Z;let[aw,ay]=(0,l.useState)([]),toggleEffect=async e=>{e5(!0);let t=aw.includes(e)?aw.filter(t=>t!==e):[...aw,e];ay(t),window.tryonEffects=t,await new Promise(e=>setTimeout(e,500)),window.dispatchEvent(new CustomEvent("tryon-effects-change",{detail:{effects:t}})),setTimeout(()=>{e5(!1)},1500)},zoomStage=e=>{if("in"===e){let e=new CustomEvent("zoom-stage",{detail:{direction:"in"}});window.dispatchEvent(e)}else{let e=new CustomEvent("zoom-stage",{detail:{direction:"out"}});window.dispatchEvent(e)}},moveStage=e=>{let t=new CustomEvent("move-stage",{detail:{direction:e}});window.dispatchEvent(t)},[ab,aj]=(0,l.useState)({width:0,height:0}),[aN,a_]=(0,l.useState)(!1);(0,l.useEffect)(()=>{e.debug&&console.log("variant",ar),e.variant&&ai(e.variant);let handleResize=()=>{aj({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",handleResize),handleResize(),()=>window.removeEventListener("resize",handleResize)},[]);let finishPositioning=()=>{var t,a;changeMode(""),!as&&(null==e?void 0:null===(a=e.trial)||void 0===a?void 0:null===(t=a.tattoo_imgs)||void 0===t?void 0:t.some(e=>e.post_source_name))&&aa(!0),tV&&"3D"!==ar||!tA||(tX(!0),tW||handleAIAutoErase({backgroundMode:!0}))},enable3D=()=>{try{e3(!0),(0,er.L)("Enable_3D_Try_On");let e=new URL(window.location.href);e.searchParams.set("use3D","true"),(0,V.q_)(e.toString())}catch(e){console.log(e)}},ak=(0,s.jsx)(s.Fragment,{children:"from_preset"!==e.trial.trial_source&&(0,s.jsxs)("div",{className:"p-4 flex gap-4 justify-center",children:[(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("div",{className:"flex items-center rounded-full bg-white p-2 px-2",children:[(0,s.jsx)(et._,{onClick:()=>{enable3D()},className:"text-sm font-semibold cursor-pointer mr-2",children:"2D"}),(0,s.jsx)(ea.r,{className:"data-[state=checked]:bg-teal-500 mr-2",id:"switch3d",onCheckedChange:e=>{enable3D()}}),(0,s.jsx)(et._,{onClick:()=>{enable3D()},className:"text-sm font-semibold cursor-pointer",children:"3D"})]})}),(0,s.jsxs)(b.z,{className:"w-full max-w-[300px] rounded-full",onClick:()=>{(0,V.q_)("/".concat(eF,"/tattoo/try"))},children:[eI.formatMessage({id:"page.tatPage.createNewTryOn"}),(0,s.jsx)(j.Z,{className:"ml-2",size:14})]})]})});return(0,s.jsxs)("div",{className:"select-none",children:[(0,s.jsxs)(x(),{children:[e.urlData&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("title",{children:[eI.formatMessage({id:"page.trypage.tryOnTool"})," | ",e.merchant.artist_name]}),(0,s.jsx)("meta",{property:"og:url",content:"https://tatship.com/".concat(eF,"/tattoo/preset-try/preview?d=").concat(null==e?void 0:null===(t=e.urlData)||void 0===t?void 0:t.url_data_id)}),(0,s.jsx)("meta",{property:"og:type",content:"website"}),(0,s.jsx)("meta",{property:"og:image",content:null==e?void 0:null===(i=e.urlData)||void 0===i?void 0:null===(a=i.stored_data)||void 0===a?void 0:a.design_image_url}),(0,s.jsx)("meta",{property:"og:title",content:"".concat(eI.formatMessage({id:"page.trypage.tryOnTool"})," | ").concat(e.merchant.artist_name)}),(0,s.jsx)("meta",{property:"og:description",content:eI.formatMessage({id:"page.trypage.tryOnToolDescription"})})]}),!e.urlData&&(0,s.jsx)("title",{children:"Tattoo Try On Tool | Tatship"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}),(null==e?void 0:null===(p=e.user)||void 0===p?void 0:p.user_tier)!=="free"&&(0,s.jsx)("meta",{name:"apple-itunes-app",content:"app-id=6746807416"})]}),e.use3D&&(0,s.jsxs)("div",{className:"relative",children:["popup"!==eH&&(((null===(E=e.preset)||void 0===E?void 0:E.merchant_id)||(null==t5?void 0:t5.includes("/preset-try/")))&&e.merchant&&(null===(K=e.preset)||void 0===K?void 0:K.merchant_id)!=="tatshiphq"?(0,s.jsxs)("div",{className:"bg-white w-full py-2 px-4 flex items-center border",children:[(0,s.jsxs)("div",{className:"text-xs text-gray-700 flex items-center cursor-pointer ".concat((null==t5?void 0:t5.includes("preset-try/preview"))?"hidden":""),onClick:()=>{window.history.back()},children:[(0,s.jsx)(U.Z,{className:"mr-1",size:14})," ","jewellery"===t6?eI.formatMessage({id:"preset.jewellery.backButtonText"}):eI.formatMessage({id:"preset.backButtonText"})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-700 flex items-center ml-auto",children:[(0,s.jsx)("img",{className:"w-8 h-8 rounded-full object-cover",src:(null==e?void 0:null===(eo=e.merchant)||void 0===eo?void 0:null===(es=eo.logo_image)||void 0===es?void 0:es.tatshipCdnSm)||(null===(ec=e.merchant)||void 0===ec?void 0:null===(ed=ec.logo_image)||void 0===ed?void 0:ed.cdnUrl)+"-/resize/300x/-/format/webp/"}),(0,s.jsx)("h5",{className:"px-2 font-semibold text-gray-700 text-xs",children:null===(em=e.merchant)||void 0===em?void 0:em.artist_name}),ax&&!e.urlData&&(0,s.jsx)("a",{onClick:()=>logPresetEvent("book_now_click"),href:ax,className:"bg-black rounded-full px-3 py-2 text-white font-semibold shadow",target:"_blank",rel:"noreferrer",children:"Book Now"})]})]}):null),(0,s.jsx)(ThreeDimensionalTryOnWidget,{onHumanImageUpload:()=>{tJ(!0)},locale:eF,user:eJ,setUser:eK,decryptionKey:e.decryptionKey,trial:eQ,trial_id:e.trial.trial_id,merchant:e.merchant,merchantConfig:e.merchantConfig,queryFileId:eG,tryonTarget:t6,preset:e.preset,styles:e.styles,shapes:e.shapes,presetId:e.trial.preset_id,forMerchant:!!e.trial.merchant_id,generationCredits:tv,setGenerationCredits:tw,addImgs:addImgs}),tY&&(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg sm:p-6 py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("img",{src:"/assets/portrait.png",className:"h-12 object-contain mr-4"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("h5",{className:"mb-2 font-bold text-sm",children:eI.formatMessage({id:"page.trypage.selectPhoto"})}),(0,s.jsx)("p",{className:"text-xs",children:eI.formatMessage({id:"page.trypage.selectPhotoDescription"})})]})]}),(0,s.jsx)(y.Z,{onImageSelected:handleHumanImageUpload}),(0,s.jsx)("div",{className:"p-2 sm:p-0",children:(0,s.jsxs)(w.bZ,{children:[(0,s.jsx)(D.Z,{className:"h-5 w-5 text-bold",strokeWidth:2.5,color:"#40bfa6"}),(0,s.jsx)("h5",{className:"text-sm font-bold mb-1",children:eI.formatMessage({id:"page.trypage.privacyProtection"})}),(0,s.jsx)("p",{className:"text-xs",children:eI.formatMessage({id:"page.trypage.privacyProtectionDescription"})})]})})]})}),eP&&(t3?(0,s.jsx)("div",{className:"fixed bottom-0 left-0 w-full h-full z-30",children:(0,s.jsx)("div",{className:"bg-black/50 bg-white z-20 shadow-xl relative w-full h-full flex justify-center items-center",style:{background:"#00000087"},children:(0,s.jsx)("div",{className:"rounded-2xl shadow-xl p-4 bg-white border",children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("div",{className:"text-cener py-2",children:(0,s.jsx)("img",{src:"https://asset.useai4work.com/tatship/brand/logo.svg",className:"h-8 mx-auto",alt:"tatship Logo"})}),(0,s.jsx)("h3",{className:"text-center text-indigo-500 font-bold mb-4 text-2xl",children:"Enjoy Using Tatship?"}),(0,s.jsxs)("p",{className:"text-xs mb-3 text-gray-700 px-2",children:["Many Features are limited in Instagram In-App browser. ",(0,s.jsx)("span",{className:"font-semibold",children:"Please use Tatship in browers like Safari / Chrome!"})]}),(0,s.jsx)("h3",{className:"text-center font-bold mt-3 text-md",children:"How To Continue Using:"}),(0,s.jsxs)("div",{className:"flex justify-center py-2 gap-4",children:[(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("img",{src:"/assets/external-browser-1.webp",className:"shadow-xl h-64 mx-auto",alt:"tatship"}),(0,s.jsxs)("p",{className:"text-xs text-gray-800 font-semibold mt-4",children:[(0,s.jsx)("span",{className:"text-indigo-600 font-bold",children:"Step 1:"})," Click Top Right Corner","'s"," ",'"',"...",'"'," button"]})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("img",{src:"/assets/external-browser-2.webp",className:"shadow-xl h-64 mx-auto",alt:"tatship"}),(0,s.jsxs)("p",{className:"text-xs text-gray-800 font-semibold mt-4",children:[(0,s.jsx)("span",{className:"text-indigo-600 font-bold",children:"Step 2:"})," Click ",'"',"Open in External Browser",'"']})]})]})]})})})}):(0,s.jsx)("div",{className:"".concat(eZ?"opacity-100":"opacity-0"," transition duration-4000 ease-in-out"),children:(0,s.jsx)($.Z,{locale:eF,onSuccess:e=>{eK(e.user),tw(e.user.tatship_generation_credits)}})}))]}),!e.use3D&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Z,{setUser:eK,merchant:e.merchant,merchantConfig:e.merchantConfig,open:t9,queryFileId:eG,tryonTarget:t6,preset:e.preset,onSuccess:e=>{eK(e.user),tw(e.user.tatship_generation_credits)},user:eJ,styles:e.styles,shapes:e.shapes,presetId:e.trial.preset_id,forMerchant:!!e.trial.merchant_id,generationCredits:tv,className:"w-full text-xs my-auto",onChange:e=>{addImgs(e.files)},hideButton:!0}),tY&&(0,s.jsx)("div",{className:"fixed top-0 left-0 z-30 w-full h-full bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg sm:p-6 py-4 px-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("img",{src:"/assets/portrait.png",className:"h-12 object-contain mr-4"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("h5",{className:"mb-2 font-bold text-sm",children:eI.formatMessage({id:"page.trypage.selectPhoto"})}),(0,s.jsx)("p",{className:"text-xs",children:eI.formatMessage({id:"page.trypage.selectPhotoDescription"})})]})]}),(0,s.jsx)(y.Z,{onImageSelected:handleHumanImageUpload}),(0,s.jsx)("div",{className:"p-2 sm:p-0",children:(0,s.jsxs)(w.bZ,{children:[(0,s.jsx)(D.Z,{className:"h-5 w-5 text-bold",strokeWidth:2.5,color:"#40bfa6"}),(0,s.jsx)("h5",{className:"text-sm font-bold mb-1",children:eI.formatMessage({id:"page.trypage.privacyProtection"})}),(0,s.jsx)("p",{className:"text-xs",children:eI.formatMessage({id:"page.trypage.privacyProtectionDescription"})})]})})]})}),(0,s.jsx)(X.Z,{zIndex:40,bgColor:"bg-gray-100",closeMode:"absolute",loading:e2,open:tL,onOpenChange:e=>{e||tO(e)},children:(0,s.jsx)("div",{children:!!tR&&(0,s.jsx)(J.Z,{onChooseMore:()=>{tO(!1),tZ(!0)},locale:eF,customizations:e.customizations,product:e.product,open:tL,shipsTo:e.shipsTo,trial:eQ,tattoo:tR})})}),(0,s.jsx)(X.Z,{zIndex:38,loading:e2,open:tT,onOpenChange:e=>{e||tZ(e)},children:(0,s.jsxs)("div",{className:"mx-auto sm:max-w-[800px] w-full sm:shadow-xl p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"py-4",children:(0,s.jsx)("h5",{className:"text-center text-gray-800 text-sm font-bold",children:"jewellery"===t6?eI.formatMessage({id:"page.trypage.jewellery.galleryHeader"}):eI.formatMessage({id:"page.trypage.galleryHeader"})})}),(0,s.jsx)("div",{className:"flex flex-wrap overflow-scroll min-[380px]:h-[480px] h-96 p-2 rounded-lg border",children:eQ.tattoo_imgs.map((t,a)=>{let l=am.find(e=>e.merchant_id===t.merchant_id);return(0,s.jsx)("div",{className:"sm:w-4/12 ".concat((t.file_name_local,"w-full")," overflow-hidden p-1"),children:(0,s.jsxs)("div",{className:"rounded-lg border relative bg-gray-50",children:[(0,s.jsx)("div",{className:"rounded-lg w-full h-32 p-2 overflow-hidden object-contain bg-contain bg-center bg-no-repeat ".concat("black-and-white"===t.color_mode?"grayscale":""),onClick:()=>{window.gtag("event","ClickGalleryImage",{})},style:{backgroundImage:"url(".concat(t.cdnUrl,")")}}),t.file_name_local&&"tatshiphq"!==t.merchant_id&&(0,s.jsx)("div",{className:"p-2 bg-white border-t",children:(0,s.jsx)("h5",{className:"text-3xs font-bold text-gray-700 truncate",children:t.file_name_local})}),merchantInfoSection(l),sourceInfoSection(t),"from_preset"!==e.trial.trial_source&&["generate","upload","text","self-design","platform-gallery"].includes(t.graphicMode)&&(0,s.jsx)("div",{className:"mt-2 p-2",children:(0,s.jsxs)(b.z,{className:"text-xs h-8 px-3 rounded-full w-full",onClick:()=>{tF(t),tO(!0)},children:[eI.formatMessage({id:"trialPage.orderTempTattoo"})," ",(0,s.jsx)(z,{className:"ml-1",size:14})]})}),(0,s.jsx)("div",{className:"absolute top-0 left-0",children:downloadGalleryImageButton(t)}),(0,s.jsxs)("div",{className:"absolute top-0 right-0 p-1",children:[(0,s.jsx)("button",{onClick:async()=>{try{await addImgs([t]),(0,er.L)("tattoo_gallery_copy",{}),tZ(!1)}catch(e){console.log(e)}},className:"m-1 bg-white border border rounded text-xs text-gray-500 p-1",children:(0,s.jsx)(M.Z,{size:14})}),eQ.tattoo_imgs.length>1&&(0,s.jsx)("button",{onClick:()=>{removeImg(t),(0,er.L)("tattoo_gallery_remove",{})},className:"m-1 bg-white border border rounded text-xs text-gray-500 p-1",children:(0,s.jsx)(C.Z,{size:14})})]})]})},a)})})]})}),(0,s.jsx)("div",{className:"".concat(e6?"modal-show w-full":"modal-hide"," tatship-css-modal bg-white"),children:(0,s.jsxs)("div",{className:"bg-white relative flex flex-col h-screen",children:[e2&&(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-white bg-opacity-90 opacity-90 z-50 flex items-center justify-center",style:(0,V.J3)(e.merchant),children:(0,s.jsxs)("div",{className:"animate-pulse flex space-x-4",children:[(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"}),(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"}),(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"})]})}),(0,s.jsxs)("div",{className:"p-2 flex absolute z-20 w-full top-0 left-0",children:[(0,s.jsx)("div",{}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsxs)(b.z,{variant:"outline",onClick:()=>{e8(!1),td("basic-position"),document.querySelector("body").style.overflow="scroll"},className:"bg-white p-2 hover:scale-105 transition duration-500 ease-in-out text-gray-600 text-xs",children:[(0,s.jsx)(C.Z,{className:"mr-1",size:14}),eI.formatMessage({id:"page.tatPage.close3DShape"})]})})]}),(0,s.jsxs)("div",{className:"grow sm:mt-12",children:[(0,s.jsxs)("div",{className:"hidden",children:[(0,s.jsxs)("h5",{className:"font-bold text-md mt-3 mb-2",children:[eI.formatMessage({id:"page.tatPage.selectedTattooPosition"}),":"]}),(0,s.jsx)("img",{className:"object-contain sm:h-full h-56 max-h-56 w-full bg-gray-100",id:"preview"})]}),(0,s.jsx)("div",{className:"sm:w-full mx-auto",children:(0,s.jsx)("div",{className:"sm:p-2 p-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap justify-center",children:[(0,s.jsxs)("div",{className:"sm:w-5/12 w-full sm:pr-8",children:[(0,s.jsxs)("select",{className:"hidden w-full px-6 py-2 shadow rounded-lg border mb-4",id:"assist-select",children:[(0,s.jsx)("option",{value:"cube",children:"Cube"}),(0,s.jsx)("option",{value:"whole-man",children:"Whole Man"})]}),(0,s.jsx)("div",{className:"",children:(0,s.jsxs)(Y.mQ,{defaultValue:"how-to-use",className:"mt-10",onValueChange:e=>{window.gtag("event","ChangeUserGuide",{event_category:e})},children:[(0,s.jsxs)(Y.dr,{children:[(0,s.jsx)(Y.SP,{value:"how-to-use",children:eI.formatMessage({id:"page.tatPage.howToUseHeader"})}),(0,s.jsx)(Y.SP,{value:"change-tattoo",children:eI.formatMessage({id:"page.tatPage.changeDesign"})}),(0,s.jsx)(Y.SP,{value:"change-size",children:eI.formatMessage({id:"page.tatPage.changeSize"})})]}),(0,s.jsx)(Y.nU,{value:"how-to-use",children:(0,s.jsx)("div",{className:"rounded-lg px-2 pt-2 pb-4",children:(0,s.jsxs)("ul",{className:"text-sm text-gray-600 list-disc ml-4 mr-12",children:[(0,s.jsx)("li",{className:"mb-1",children:eI.formatMessage({id:"page.tatPage.howToUse1"})}),(0,s.jsx)("li",{className:"mb-1",children:eI.formatMessage({id:"page.tatPage.howToUse2"})}),(0,s.jsx)("li",{className:"mb-1",children:eI.formatMessage({id:"page.tatPage.howToUse3"})})]})})}),(0,s.jsx)(Y.nU,{value:"change-tattoo",children:(0,s.jsx)("div",{className:"border rounded-lg p-4 mb-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex overflow-scroll",children:eQ.tattoo_imgs.map((e,t)=>(0,s.jsx)("div",{className:"w-10 h-10 cursor-pointer rounded-lg border overflow-hidden m-1 "+(ty===e.cdnUrl?"border-4 border-black shadow-xl":""),onClick:()=>{tb(e.cdnUrl),window.currentMaterialUrl=e.cdnUrl},children:(0,s.jsx)("img",{className:"w-full h-full object-contain",src:e.cdnUrl})},t))}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:eI.formatMessage({id:"page.tatPage.decalSizeDescription"})})]})})}),(0,s.jsx)(Y.nU,{value:"change-size",children:(0,s.jsxs)("div",{className:"py-4 px-4 border rounded-xl mb-4 relative",children:[(0,s.jsxs)("h5",{className:"flex mb-3 text-sm font-bold",children:[(0,s.jsx)(I,{className:"h-4 w-4 mr-3"}),"  ",eI.formatMessage({id:"page.tatPage.decalSizeHeader"})]}),(0,s.jsx)(G.i,{className:"cursor-pointer mb-2 w-full",defaultValue:[36],min:10,max:50,step:1,onValueChange:e=>{window.tatshipDecalScale=e,tS(!0),setTimeout(()=>{tS(!1)},2e3)}}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:eI.formatMessage({id:"page.tatPage.decalSizeDescription"})})]})})]})})]}),(0,s.jsx)("div",{className:"sm:w-auto w-full flex justify-center ",children:(0,s.jsx)("div",{id:"container-3d",style:{height:320,width:320},className:"outline-4 outline-slate-600 outline-dotted rounded-xl overflow-hidden shadow-xl"})}),(0,s.jsxs)("div",{className:"px-4 py-4 sm:p-8 w-full text-center",children:[(0,s.jsx)(b.z,{size:"sm",className:"shadow select-none ml-auto font-bold sm:px-24 px-6 ease-in-out duration-500 hover:scale-105 transition",onClick:e=>{window.materialMetaData={},(eQ.tattoo_imgs||[]).forEach(e=>{window.materialMetaData[e.cdnUrl]=e}),e.stopPropagation(),e3(!0),window.gtag("event","ConfirmChange3DShape",{}),setTimeout(()=>{e3(!1)},3e3)},id:"shape-capture",children:e2?"Processing ...":eI.formatMessage({id:"page.tatPage.confirmShape"})}),(0,s.jsx)("div",{id:"debuglog"})]})]})})})]})]})}),tM&&(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-white bg-opacity-90 opacity-90 z-50 flex items-center justify-center",style:(0,V.J3)(e.merchant),children:(0,s.jsxs)("div",{className:"animate-pulse flex space-x-4",children:[(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"}),(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"}),(0,s.jsx)("div",{className:"rounded-full bg-slate-400 h-2 w-2"})]})}),(0,s.jsx)(c.Z,{open:eX,onClose:()=>eY(!1),children:(0,s.jsx)(o.Z,{})}),eO&&(0,s.jsx)("div",{className:"".concat(eO?"opacity-100":"opacity-0"," transition duration-4000 ease-in-out text-left"),children:(0,s.jsx)($.Z,{mode:"multiple-credit-offers",showCloseButton:!0,onClose:()=>{eR(!1)},onSuccess:e=>{eK&&eK(e.user),tw(e.user.tatship_generation_credits)}})}),(0,s.jsx)(c.Z,{open:aN,onClose:()=>a_(!1),children:(0,s.jsxs)("div",{className:"p-6 relative",children:[e2&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white bg-opacity-90 z-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"loader-2"})}),(0,s.jsx)("h3",{className:"tracking-tight text-center text-lg font-bold bg-gradient-to-r from-purple-600 to-orange-600 bg-clip-text text-transparent mb-2 font-semibold font-serif",children:eI.formatMessage({id:"purchase.3DTryOnIsMoreRealistic"})}),(0,s.jsx)("p",{className:"text-center text-xs mb-6 text-neutral-500 mb-6",children:eI.formatMessage({id:"trialPage.enable3DTryOnDescription"})}),(0,s.jsx)("div",{children:(0,s.jsx)("video",{className:"h-56 w-full object-contain bg-gradient-light rounded-3xl overflow-hidden sm:max-w-[500px]",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,children:(0,s.jsx)("source",{src:"/assets/3d_try_on_demo.mp4",type:"video/mp4"})})}),(0,s.jsx)("div",{className:"p-3",children:(0,s.jsx)(b.z,{className:"rounded-full w-full shadow-obvious bg-gradient-to-r from-purple-600 to-orange-600",onClick:async()=>{(0,er.L)("Enable_3D_Try_On");let e=new URL(window.location.href);e.searchParams.set("use3D","true"),window.location.href=e.toString()},children:eI.formatMessage({id:"trialPage.enable3DTryOn"})})})]})}),(0,s.jsxs)(c.Z,{open:e0,onClose:()=>e1(!1),children:[(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("h3",{className:"font-bold text-center",children:eI.formatMessage({id:"page.tatPage.pleaseSelectImages"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex flex-wrap p-2 mr-auto justify-center",children:eQ.tattoo_imgs.map((e,t)=>(0,s.jsxs)("div",{className:"relative w-24 h-24 rounded-lg border shadow-xl cursor-pointer overflow-hidden m-1 "+(tN[e.cdnUrl]?"border-4 border-black":"border-4 border-gray-100"),onClick:()=>toggleSelectedImage(e),children:[(0,s.jsx)("img",{className:"w-full h-full object-contain",src:e.cdnUrl}),tN[e.cdnUrl]?(0,s.jsx)("div",{className:"absolute top-0 right-1 z-20 rounded-lg",children:(0,s.jsx)(m.G,{className:"font-bold",size:"xs",icon:u.LEp})}):null]},t))}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("button",{className:"text-sm bg-black font-bold text-white w-full shadow-xl hover:scale-105 transition duration-900 ease-in-and-out px-4 py-3 rounded-lg",onClick:()=>{createDesign()},children:[eI.formatMessage({id:"page.refImageFinder.done"}),(0,s.jsx)(m.G,{className:"font-bold ml-2",icon:u.eFW})]})})]})]}),(0,s.jsx)("div",{className:"bottom-0 left-0 sm:fixed ".concat(e.host.includes("embed.tatship.com")?"absolute":"fixed"," w-full bg-white z-20 top-shadow ").concat((null===(eu=e.trial)||void 0===eu||eu.merchant_id,""))+("inpaint"===tj||tx?"hidden":""),children:(0,s.jsxs)("div",{className:"mx-auto sm:border bg-white relative border-b",style:{maxWidth:800},children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{style:{pointerEvents:"none"},className:"".concat(te?"modal-show":"modal-hide hidden"," absolute bottom-0 left-0 sm:left-48 w-full flex flex-col z-30"),children:(0,s.jsxs)("div",{className:"relative mt-auto shadow-xl rounded-lg sm:ml-auto sm:mr-20 sm:mb-48 sm:w-[300px]",children:[(0,s.jsxs)("div",{className:"flex absolute w-full top-0 left-0",children:[(0,s.jsx)("div",{}),(0,s.jsx)("div",{className:"ml-auto",style:{pointerEvents:"initial"},children:(0,s.jsx)("button",{onClick:()=>{tt(!1)},className:"bg-white px-4 py-2 rounded-lg border shadow-lg",children:(0,s.jsx)(m.G,{className:"text-gray-500 text-lg",icon:u.NBC})})})]}),(0,s.jsxs)("div",{className:"w-full rounded-lg p-4 bg-white mt-6",style:{pointerEvents:"initial"},children:[(0,s.jsx)("h5",{className:"mb-1 text-gray-800 text-sm tracking-tighter",children:eI.formatMessage({id:"page.tatPage.effectHeader"})}),(0,s.jsx)("p",{className:"text-3xs text-gray-500 mb-4",children:eI.formatMessage({id:"page.tatPage.effectDescription"})}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:["ink_effect","remove_white_ink"].map(e=>(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"rounded-full px-2 py-1 border border-gray-300 text-2xs tracking-tighter cursor-pointer ".concat(aw.includes(e)?"bg-black text-white":""),onClick:()=>toggleEffect(e),children:eI.formatMessage({id:"page.tatPage."+e})})},e))}),(0,s.jsxs)("div",{className:"pb-6",children:[(0,s.jsxs)("h5",{className:"mb-4 text-gray-800 text-sm tracking-tighter",children:[eI.formatMessage({id:"page.tatPage.tattooOpacity"})," ","[",tl,"%","]"]}),(0,s.jsx)(G.i,{defaultValue:[tl],max:100,step:1,className:"w-full cursor-pointer",onValueChange:e=>{tr(e);let t=new CustomEvent("tattoo-opacity-change",{detail:{value:100-e}});window.dispatchEvent(t)}})]})]})]})}),(0,s.jsx)("div",{className:"".concat("erase"===to?"block":"hidden"," absolute bottom-0 left-0 w-full z-30"),children:(0,s.jsx)("div",{className:"relative mt-auto shadow-xl rounded-lg bg-white top-shadow",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("h5",{className:"text-neutral-500 text-xs flex",children:[(0,s.jsx)(P.Z,{className:"w-4 h-4 mr-2"}),eI.formatMessage({id:"page.tatPage.howToErase"})]})}),(0,s.jsx)("div",{}),(0,s.jsxs)("button",{className:"border py-2 rounded-full px-4 shadow text-xs text-neutral-500",id:"clear-erase",children:[(0,s.jsx)(m.G,{className:"text-neutral-500 mr-1",icon:u.QDM})," ",eI.formatMessage({id:"page.tatPage.clearEraser"})]}),(0,s.jsxs)("button",{className:"ml-4 border py-2 rounded-full px-4 shadow text-xs text-neutral-500",onClick:()=>{changeMode("basic-position"),finishPositioning()},children:[(0,s.jsx)(m.G,{className:"text-green-600 mr-1",icon:u.LEp})," ",eI.formatMessage({id:"page.tatPage.doneEraser"})]})]})})}),(0,s.jsx)("div",{className:"".concat("hidden"," absolute bottom-0 left-0 w-full z-30"),children:(0,s.jsx)("div",{className:"relative mt-auto overflow-hidden rounded-t-2xl bg-white top-shadow",children:(0,s.jsx)("div",{className:"",children:(0,s.jsx)("div",{className:"p-3 md:p-4 px-4 py-6",children:(0,s.jsxs)("h5",{className:"text-gray-800 text-sm flex",children:[(0,s.jsxs)("div",{className:"flex flex-col mr-2",children:[(0,s.jsx)("div",{className:"md:block hidden my-auto",children:"jewellery"===t6?eI.formatMessage({id:"page.tatPage.howToMove.jewellery"}):eI.formatMessage({id:"page.tatPage.howToMove"})}),"tattoo"===t6&&(0,s.jsx)("div",{className:"md:hidden text-2xs md:text-xs text-gray-500",children:eI.formatMessage({id:"page.tatPage.howToMove1.mobile.tattoo"})}),"tattoo"===t6&&(0,s.jsx)("div",{className:"md:hidden text-2xs md:text-xs text-gray-500",children:eI.formatMessage({id:"page.tatPage.howToMove2.mobile.tattoo"})})]}),(0,s.jsx)(b.z,{variant:"outline",className:"shadow-obvious border-0 ml-auto my-auto rounded-full",onClick:()=>{finishPositioning()},children:(0,s.jsx)(m.G,{className:"text-green-600",icon:u.LEp})})]})})})})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"flex flex-nowrap justify-center",children:[(0,s.jsxs)("div",{className:"w-3/12 cursor-pointer relative",onClick:()=>{changeMode("basic-position"),tE||(tz(!0),window.gtag("event","StartAction",{event_category:"From_TrialPage"}))},children:[!tE&&(0,s.jsx)("span",{className:"rounded-full animate-ping absolute inline-flex h-12 w-12 top-0 left-8 md:left-16 bg-pink-800 opacity-90"}),(0,s.jsx)("div",{className:"flex px-4 py-4 lg:p-6 relative",children:(0,s.jsx)(T.Z,{className:"w-4 h-4 m-auto"})})]}),(0,s.jsxs)("div",{className:"w-3/12 cursor-pointer relative",onClick:()=>{changeMode("erase"),as||al(!0)},children:[at&&!as&&(0,s.jsx)("span",{className:"rounded-full animate-ping absolute inline-flex h-12 w-12 top-0 left-8 md:left-16 bg-violet-600 opacity-90"}),(0,s.jsx)("div",{className:"flex px-4 py-4 lg:p-6",children:(0,s.jsx)(P.Z,{className:"w-4 h-4 m-auto"})})]}),(0,s.jsx)("div",{className:"w-3/12 cursor-pointer ".concat("jewellery"!==t6?"":"hidden"),onClick:()=>tt(!0),children:(0,s.jsx)("div",{className:"flex px-4 py-4 lg:p-6",children:(0,s.jsx)(Z.Z,{className:"w-4 h-4 m-auto"})})}),(0,s.jsx)("div",{className:"w-3/12 cursor-pointer",id:"open-export-frame",onClick:()=>ts(!0),children:(0,s.jsx)("div",{className:"flex px-4 py-4 lg:p-6",children:(0,s.jsx)(L.Z,{className:"w-4 h-4 m-auto"})})}),"jewellery"===t6&&"popup"===eH&&(0,s.jsx)("div",{className:"border-l sm:flex hidden items-center justify-center",onClick:()=>{t7(!0),logPresetEvent("book_now_click"),setTimeout(()=>{t7(!1),(0,V.Vj)("close_popup",null,null)},500)},children:(0,s.jsx)("div",{className:"px-4 py-2",children:(0,s.jsxs)(b.z,{className:"w-full font-bold rounded-lg",children:[(0,s.jsx)(O,{className:"mr-2",size:14})," ",t8?(0,s.jsx)("span",{className:"px-12 text-center",children:(0,s.jsx)(R.Z,{className:"animate-spin",size:14})}):eI.formatMessage({id:"page.tatPage.proceedToBuy"})]})})})]}),(0,s.jsx)("div",{className:"lg:hidden",children:ak}),"jewellery"===t6&&"popup"===eH&&(0,s.jsx)("div",{className:"sm:hidden",onClick:()=>{t7(!0),logPresetEvent("book_now_click"),setTimeout(()=>{t7(!1),(0,V.Vj)("close_popup",null,null)},500)},children:(0,s.jsx)("div",{className:"px-4 py-2",children:(0,s.jsxs)(b.z,{className:"w-full font-bold rounded-xl",children:[(0,s.jsx)(O,{className:"mr-2",size:14})," ",t8?(0,s.jsx)("span",{className:"px-12 text-center",children:(0,s.jsx)(R.Z,{className:"animate-spin",size:14})}):eI.formatMessage({id:"page.tatPage.proceedToBuy"})]})})})]})]}),"from_preset"==e.trial.trial_source&&!!af&&!e.urlData&&"jewellery"!==t6&&(0,s.jsx)("div",{className:"sm:hidden sm:p-3 p-2 border-t flex justify-center",children:(0,s.jsxs)("a",{rel:"noreferrer",target:"_blank",onClick:()=>logPresetEvent("book_now_click"),href:ax,className:"shadow-xl bg-black text-white font-semibold w-full sm:w-[300px] block text-center rounded-full py-2 sm:py-1 flex items-center justify-center",children:["whatsapp"===e.merchant.main_contact_method&&(0,s.jsx)("img",{className:"mr-2",src:"/assets/whatsapp.png",style:{height:14,width:14}}),"line"===e.merchant.main_contact_method&&(0,s.jsx)("img",{className:"mr-2",src:"/assets/line.png",style:{height:20,width:20}}),af]})})]})}),(0,s.jsx)("div",{className:"".concat(ta?"modal-show":"modal-hide"," tatship-css-modal p-6"),style:{zIndex:40},children:(0,s.jsxs)("div",{className:"bg-gray-200 rounded-2xl overflow-scroll relative flex justify-center sm:max-w-sm mx-auto",style:{maxHeight:"95vh"},children:[(0,s.jsxs)("div",{className:"p-2 flex absolute w-full top-0 left-0",children:[(0,s.jsx)("div",{}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)("button",{onClick:()=>{ts(!1)},className:"h-10 w-10 bg-white p-2 rounded-lg border shadow-lg",children:(0,s.jsx)(m.G,{className:"text-gray-500 text-lg",icon:u.NBC})})})]}),(0,s.jsx)("div",{className:"bg-white w-full",children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("img",{className:"sm:h-[500px] h-[500px] w-full object-contain sm:mb-4 bg-gray-100 ph-no-capture",src:an}),(0,s.jsx)("img",{className:"hidden h-full w-full object-contain sm:mb-4 bg-gray-100 ph-no-capture",id:"readyexport"})]}),(0,s.jsxs)("div",{className:"px-4 pb-4",children:[(0,s.jsxs)(b.z,{className:"text-xs w-full sm:hidden flex mt-4",onClick:async()=>{console.log("Export"),(0,er.L)("shareOrSaveOutputFromTryOn");try{var t;let a=document.querySelector("#readyexport").src;["livebytheswordtattoo-demo","livebytheswordtattoo"].includes(null==e?void 0:null===(t=e.merchant)||void 0===t?void 0:t.merchant_id)&&(a=await addTattooFileInfo(a)),(0,V.u5)(a,"tattoo_try_on_result.png","Check out my Tattoo Try On!"+(av?"":"\nCreated with https://tatship.com"))}catch(e){console.log(e),tQ(!0)}},children:["Share / Save Image ",(0,s.jsx)(L.Z,{className:"ml-1",size:14})]}),(0,s.jsxs)(b.z,{className:"mt-4 text-xs w-full sm:flex ".concat(tK?"flex":"hidden"),onClick:()=>{console.log("Export"),window.gtag("event","ExportTrial",{})},id:"export",children:[eI.formatMessage({id:"page.tatPage.downloadButton"})," ",(0,s.jsx)(L.Z,{className:"ml-1",size:14})]}),!e.merchant&&(0,s.jsxs)(b.z,{className:"text-xs w-full sm:hidden flex mt-4",variant:"outline",onClick:()=>{(0,er.L)("shareOrSaveInfoFromTryOn");try{(0,V.Hz)("Share your chosen designs with this link","My Chosen Designs\nhttps://tatship.com/".concat(eF,"/tattoo/try/info/").concat(e.trial.trial_id,"?st=").concat(e.trial.info_token))}catch(e){console.log(e),window.alert("Share Feature Not Supported")}},children:["Share / Save Chosen Designs ",(0,s.jsx)(F.Z,{className:"ml-1",size:14})]})]})]})})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap h-fit max-[380px]:pb-28 max-[400px]:pb-36 min-[420px]:pb-48 sm:pb-0 bg-gradient-light justify-center",children:["popup"===eH&&(0,s.jsxs)("div",{className:"w-full pt-4 px-4 flex items-center justify-between sticky top-0",children:[(0,s.jsx)("div",{className:"p-2 shadow rounded pl-2",children:(0,s.jsxs)("span",{className:"text-xs font-semibold text-gray-700 flex items-center",children:[(0,s.jsx)(A.Z,{className:"mr-1",size:16})," Virtual Try-On"]})}),(0,s.jsxs)("div",{className:"shadow-xl font-semibold w-fit border rounded-lg px-2 py-2 text-xs text-gray-700 flex items-center cursor-pointer",onClick:()=>{(0,V.Vj)("close_popup",null,null)},children:[(0,s.jsx)(C.Z,{className:"mr-1",size:16})," ","jewellery"===t6?eI.formatMessage({id:"preset.jewellery.closeButtonText"}):eI.formatMessage({id:"preset.closeButtonText"})]})]}),"popup"!==eH&&(((null===(eh=e.preset)||void 0===eh?void 0:eh.merchant_id)||(null==t5?void 0:t5.includes("/preset-try/")))&&e.merchant&&(null===(eg=e.preset)||void 0===eg?void 0:eg.merchant_id)!=="tatshiphq"?(0,s.jsxs)("div",{className:"bg-white w-full py-2 px-4 flex items-center border",children:[(0,s.jsxs)("div",{className:"text-xs text-gray-700 flex items-center cursor-pointer ".concat((null==t5?void 0:t5.includes("preset-try/preview"))?"hidden":""),onClick:()=>{window.history.back()},children:[(0,s.jsx)(U.Z,{className:"mr-1",size:14})," ","jewellery"===t6?eI.formatMessage({id:"preset.jewellery.backButtonText"}):eI.formatMessage({id:"preset.backButtonText"})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-700 flex items-center ml-auto",children:[(0,s.jsx)("img",{className:"w-8 h-8 rounded-full object-cover",src:(null==e?void 0:null===(ex=e.merchant)||void 0===ex?void 0:null===(ep=ex.logo_image)||void 0===ep?void 0:ep.tatshipCdnSm)||(null===(ev=e.merchant)||void 0===ev?void 0:null===(ef=ev.logo_image)||void 0===ef?void 0:ef.cdnUrl)+"-/resize/300x/-/format/webp/"}),(0,s.jsx)("h5",{className:"px-2 font-semibold text-gray-700 text-xs",children:null===(ew=e.merchant)||void 0===ew?void 0:ew.artist_name}),ax&&!e.urlData&&(0,s.jsx)("a",{onClick:()=>logPresetEvent("book_now_click"),href:ax,className:"sm:block hidden bg-black rounded-full px-3 py-2 text-white font-semibold shadow",target:"_blank",rel:"noreferrer",children:"Book Now"})]})]}):null),(0,s.jsx)("div",{className:"lg:w-5/12 md:w-7/12 w-full sm:h-full sm:pt-2 bg-transparent",children:(0,s.jsxs)("div",{className:"relative",children:[tx&&(0,s.jsx)("div",{className:"w-full h-full absolute top-0 left-0 bg-white opacity-90 z-30",children:(0,s.jsx)("div",{className:"flex p-4 mb-4 justify-center h-full",children:(0,s.jsxs)("div",{className:"my-auto",children:[(0,s.jsx)("div",{className:"px-4 py-6 flex justify-center",children:(0,s.jsx)("img",{className:"animate-bounce w-12 h-12",src:"/assets/example-generation.png"})}),(0,s.jsx)("h5",{className:"text-sm font-bold",children:eI.formatMessage({id:"page.trypage.imageLoading"})}),tu&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h5",{className:"text-sm font-bold",children:eI.formatMessage({id:"page.trypage.imageGenerating"})}),(0,s.jsxs)("h5",{className:"text-base text-gray-800 mt-2 font-bold",children:['"',tu,'"']}),(0,s.jsx)("h6",{className:"text-xs text-gray-600 mt-2 font-bold",children:eI.formatMessage({id:"page.trypage.tryMoreTimes"})})]})]})})}),e7&&(0,s.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 h-screen w-full bg-black/50",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute -top-2 -right-2",style:{zIndex:60},children:(0,s.jsx)("div",{className:"rounded-full bg-white p-2 shadow-lg cursor-pointer",onClick:()=>e9(!1),children:(0,s.jsx)(C.Z,{size:16})})}),(0,s.jsx)("div",{className:"rounded-xl overflow-hidden"})]})})}),(0,s.jsx)("div",{className:"p-2 sm:p-0 sm:border-none",children:ap}),(0,s.jsx)("div",{className:"flex justify-center relative pt-4 pb-24",children:(0,s.jsxs)("div",{className:"relative rounded-xl overflow-hidden",children:[(0,s.jsx)("div",{className:"hidden lg:block lg:fixed lg:top-30 lg:right-0 lg:z-20 p-2 bg-white rounded-l-full shadow-xl",children:ak}),"from_preset"===e.trial.trial_source&&(0,s.jsx)("div",{className:"absolute top-0 left-0 z-30 flex justify-end w-full p-3",children:(0,s.jsxs)("div",{className:"".concat(tE?"":"hidden"," shadow-obvious bg-white border-0 text-xs rounded-full px-3 py-1 ").concat("jewellery"!==t6?"":"hidden"),onClick:()=>{changeMode("shape"),"3D"===ar?e9(!0):e8(!0),document.querySelector("body").style.overflow="hidden",window.gtag("event","OpenChange3DShapeModal",{})},children:[(0,s.jsx)(m.G,{icon:u.hGM,className:"mr-1"})," ",eI.formatMessage({id:"page.tatPage.openChangeShapeButtonText"})]})}),"from_preset"!==e.trial.trial_source&&(0,s.jsx)("div",{className:"absolute md:bottom-6 bottom-6 left-3 cursor-pointer",style:{zIndex:2},children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(b.z,{variant:"outline",onClick:()=>zoomStage("in"),className:"text-xs h-6 text-xs px-1 shadow",children:(0,s.jsx)(k.Z,{size:14})}),(0,s.jsx)(b.z,{variant:"outline",onClick:()=>zoomStage("out"),className:"text-xs h-6 text-xs px-1 shadow",children:(0,s.jsx)(B.Z,{size:14})})]})}),"from_preset"!==e.trial.trial_source&&(0,s.jsx)("div",{className:"absolute md:bottom-6 bottom-6 right-3 cursor-pointer",style:{zIndex:2},children:(0,s.jsxs)("div",{className:"flex gap-2 items-end pointer-events-none",children:[(0,s.jsx)(b.z,{variant:"outline",onClick:()=>moveStage("left"),className:"text-xs h-6 text-2xs px-1 pointer-events-auto shadow",children:(0,s.jsx)(W.Z,{size:16})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(b.z,{variant:"outline",onClick:()=>moveStage("up"),className:"text-xs h-6 text-2xs px-1 pointer-events-auto shadow",children:(0,s.jsx)(q.Z,{size:16})}),(0,s.jsx)(b.z,{variant:"outline",onClick:()=>moveStage("down"),className:"text-xs h-6 text-2xs px-1 pointer-events-auto shadow",children:(0,s.jsx)(H.Z,{size:16})})]}),(0,s.jsx)(b.z,{variant:"outline",onClick:()=>moveStage("right"),className:"text-xs h-6 text-2xs px-1 pointer-events-auto shadow",children:(0,s.jsx)(j.Z,{size:16})})]})}),e4&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-200 opacity-30 z-10",children:(0,s.jsx)("div",{className:"flex p-4 mb-4 justify-center h-full",children:(0,s.jsx)("div",{className:"my-auto",children:(0,s.jsx)(R.Z,{className:"animate-spin",size:32})})})}),(0,s.jsx)("div",{className:"sm:rounded-lg overflow-hidden shadow-xl border bg-gray-100",style:(0,V.s2)(e.headers)?{height:510,width:340}:{height:600,width:400},id:"container"}),!to&&(0,s.jsx)("div",{className:"absolute w-full h-full top-0 left-0",onClick:()=>{changeMode("basic-position")},style:{},id:"scroller"})]})}),"inpaint"===tj&&!tx&&(0,s.jsx)("div",{className:"bottom-0 left-0 fixed z-30 w-full",children:(0,s.jsx)("div",{className:"sm:p-0 p-4 sm:w-8/12 sm:mx-auto w-full p-4 bg-white top-shadow rounded-t-lg overflow-hidden",children:ah})})]})}),eP&&(t3?(0,s.jsx)("div",{className:"fixed bottom-0 left-0 w-full h-full z-30",children:(0,s.jsx)("div",{className:"bg-black/50 bg-white z-20 shadow-xl relative w-full h-full flex justify-center items-center",style:{background:"#00000087"},children:(0,s.jsx)("div",{className:"rounded-2xl shadow-xl p-4 bg-white border",children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("div",{className:"text-cener py-2",children:(0,s.jsx)("img",{src:"https://asset.useai4work.com/tatship/brand/logo.svg",className:"h-8 mx-auto",alt:"tatship Logo"})}),(0,s.jsx)("h3",{className:"text-center text-indigo-500 font-bold mb-4 text-2xl",children:"Enjoy Using Tatship?"}),(0,s.jsxs)("p",{className:"text-xs mb-3 text-gray-700 px-2",children:["Many Features are limited in Instagram In-App browser. ",(0,s.jsx)("span",{className:"font-semibold",children:"Please use Tatship in browers like Safari / Chrome!"})]}),(0,s.jsx)("h3",{className:"text-center font-bold mt-3 text-md",children:"How To Continue Using:"}),(0,s.jsxs)("div",{className:"flex justify-center py-2 gap-4",children:[(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("img",{src:"/assets/external-browser-1.webp",className:"shadow-xl h-64 mx-auto",alt:"tatship"}),(0,s.jsxs)("p",{className:"text-xs text-gray-800 font-semibold mt-4",children:[(0,s.jsx)("span",{className:"text-indigo-600 font-bold",children:"Step 1:"})," Click Top Right Corner","'s"," ",'"',"...",'"'," button"]})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("img",{src:"/assets/external-browser-2.webp",className:"shadow-xl h-64 mx-auto",alt:"tatship"}),(0,s.jsxs)("p",{className:"text-xs text-gray-800 font-semibold mt-4",children:[(0,s.jsx)("span",{className:"text-indigo-600 font-bold",children:"Step 2:"})," Click ",'"',"Open in External Browser",'"']})]})]})]})})})}):(0,s.jsx)("div",{className:"".concat(eZ?"opacity-100":"opacity-0"," transition duration-4000 ease-in-out"),children:(0,s.jsx)($.Z,{locale:eF,onSuccess:e=>{eK(e.user),tw(e.user.tatship_generation_credits)}})}))]}),!!eJ&&(0,s.jsxs)(s.Fragment,{children:[e.modelAllow&&(0,s.jsx)(n(),{id:"model-settings",dangerouslySetInnerHTML:{__html:'if ("'.concat(null===(eb=e.trial)||void 0===eb?void 0:null===(ey=eb.img_obj)||void 0===ey?void 0:ey.cdnUrl,'" === "https://tatship.com/assets/man_try_on_front.jpg") {\n                                window.modelCustomFunc = function(mesh) { \n                                    mesh.scale.set(60, 60, 60); \n                                    mesh.position.y = 10;\n                                    mesh.rotation.y = Math.PI;\n                                    mesh.position.z = -30;\n                                };\n                                window.custom_assist_obj_url = \'https://asset.useai4work.com/tatship/assist/man_body_front.obj\';\n                            }')}}),(0,s.jsx)(n(),{id:"set-window-data",dangerouslySetInnerHTML:{__html:'window.tryonEffects=[];window.tryonTarget="'.concat(t6,'";window.trial_data = ').concat(JSON.stringify(e.trial),";window.transformed_tattoo = '';window.tatshipFeaturesAllowed=\"").concat(((null==e?void 0:null===(ej=e.merchantConfig)||void 0===ej?void 0:ej.features_allowed)||[]).join(","),'";window.tatshipMerchantTier="').concat(null==e?void 0:null===(eN=e.merchantConfig)||void 0===eN?void 0:eN.user_tier,'";window.tatshipExportWatermarkUrl=').concat((null==e?void 0:null===(e_=e.merchantConfig)||void 0===e_?void 0:e_.watermark_image_url)?'"'+(null==e?void 0:null===(ek=e.merchantConfig)||void 0===ek?void 0:ek.watermark_image_url)+'"':'"https://static.tatship.com/application/try_on_watermark_v2.png"')}}),(0,s.jsx)(n(),{id:"set-debug-var",dangerouslySetInnerHTML:{__html:"window.debug = ".concat(e.debug,';window.decryptionKey="').concat(e.decryptionKey,'";')}}),(0,s.jsx)(n(),{id:"main-script",strategy:"afterInteractive",src:"/scripts/dist/index.bundle.js"}),(0,s.jsx)(n(),{id:"main-script",strategy:"afterInteractive",src:"/scripts/dist/main.bundle.js"})]})]})]})}},60761:function(e,t,a){"use strict";a.d(t,{bU:function(){return b},fC:function(){return y}});var s=a(67294),l=a(36206),r=a(28771),i=a(25360),n=a(77342),o=a(57898),d=a(7546),c=a(75320),m=a(85893),u="Switch",[h,g]=(0,i.b)(u),[p,x]=h(u),f=s.forwardRef((e,t)=>{let{__scopeSwitch:a,name:i,checked:o,defaultChecked:d,required:u,disabled:h,value:g="on",onCheckedChange:x,form:f,...v}=e,[w,y]=s.useState(null),b=(0,r.e)(t,e=>y(e)),j=s.useRef(!1),N=!w||f||!!w.closest("form"),[_=!1,k]=(0,n.T)({prop:o,defaultProp:d,onChange:x});return(0,m.jsxs)(p,{scope:a,checked:_,disabled:h,children:[(0,m.jsx)(c.WV.button,{type:"button",role:"switch","aria-checked":_,"aria-required":u,"data-state":getState(_),"data-disabled":h?"":void 0,disabled:h,value:g,...v,ref:b,onClick:(0,l.M)(e.onClick,e=>{k(e=>!e),N&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),N&&(0,m.jsx)(BubbleInput,{control:w,bubbles:!j.current,name:i,value:g,checked:_,required:u,disabled:h,form:f,style:{transform:"translateX(-100%)"}})]})});f.displayName=u;var v="SwitchThumb",w=s.forwardRef((e,t)=>{let{__scopeSwitch:a,...s}=e,l=x(v,a);return(0,m.jsx)(c.WV.span,{"data-state":getState(l.checked),"data-disabled":l.disabled?"":void 0,...s,ref:t})});w.displayName=v;var BubbleInput=e=>{let{control:t,checked:a,bubbles:l=!0,...r}=e,i=s.useRef(null),n=(0,o.D)(a),c=(0,d.t)(t);return s.useEffect(()=>{let e=i.current,t=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(t,"checked"),r=s.set;if(n!==a&&r){let t=new Event("click",{bubbles:l});r.call(e,a),e.dispatchEvent(t)}},[n,a,l]),(0,m.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...r,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function getState(e){return e?"checked":"unchecked"}var y=f,b=w},88773:function(e,t,a){"use strict";let s;a.d(t,{Z:function(){return esm_browser_v4}});let l="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var r={randomUUID:l};let i=new Uint8Array(16),n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));var esm_browser_v4=function(e,t,a){if(r.randomUUID&&!t&&!e)return r.randomUUID();e=e||{};let l=e.random??e.rng?.()??function(){if(!s){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");s=crypto.getRandomValues.bind(crypto)}return s(i)}();if(l.length<16)throw Error("Random bytes length must be >= 16");if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t){if((a=a||0)<0||a+16>t.length)throw RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[a+e]=l[e];return t}return function(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}(l)}}},function(e){e.O(0,[911,3737,8797,374,814,6685,729,2993,4339,523,1140,4277,9894,1982,1097,203,8990,4604,510,5663,9851,6087,9774,2888,179],function(){return e(e.s=87720)}),_N_E=e.O()}]);